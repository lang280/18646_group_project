===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.1629 ms
  Min time:     0.1618 ms
  Max time:     0.1648 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        196484.48 images/sec
    Computational:     39.44 GFLOPS
    Memory bandwidth:  6.37 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.1630 ms
  Min time:     0.1618 ms
  Max time:     0.1643 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        392651.22 images/sec
    Computational:     78.81 GFLOPS
    Memory bandwidth:  7.80 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.3152 ms
  Min time:     0.3138 ms
  Max time:     0.3170 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        406118.38 images/sec
    Computational:     81.51 GFLOPS
    Memory bandwidth:  5.51 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.6280 ms
  Min time:     0.6267 ms
  Max time:     0.6297 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        407652.47 images/sec
    Computational:     81.82 GFLOPS
    Memory bandwidth:  4.25 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 1.0752 ms
  Min time:     0.5325 ms
  Max time:     1.0979 ms
  Std dev:      0.0974 ms
  Performance metrics:
    Throughput:        476182.47 images/sec
    Computational:     95.57 GFLOPS
    Memory bandwidth:  4.22 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.9853 ms
  Min time:     0.8958 ms
  Max time:     1.0390 ms
  Std dev:      0.0555 ms
  Performance metrics:
    Throughput:        1039309.19 images/sec
    Computational:     208.59 GFLOPS
    Memory bandwidth:  8.40 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0891 ms
  Min time:     0.0881 ms
  Max time:     0.0901 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        358974.94 images/sec
    Computational:     72.05 GFLOPS
    Memory bandwidth:  11.64 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0832 ms
  Min time:     0.0820 ms
  Max time:     0.0842 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        768905.19 images/sec
    Computational:     154.32 GFLOPS
    Memory bandwidth:  15.27 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.1436 ms
  Min time:     0.1421 ms
  Max time:     0.1515 ms
  Std dev:      0.0012 ms
  Performance metrics:
    Throughput:        891303.12 images/sec
    Computational:     178.89 GFLOPS
    Memory bandwidth:  12.10 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.2758 ms
  Min time:     0.2740 ms
  Max time:     0.2778 ms
  Std dev:      0.0012 ms
  Performance metrics:
    Throughput:        928289.62 images/sec
    Computational:     186.31 GFLOPS
    Memory bandwidth:  9.69 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.4919 ms
  Min time:     0.4752 ms
  Max time:     0.5180 ms
  Std dev:      0.0170 ms
  Performance metrics:
    Throughput:        1040899.88 images/sec
    Computational:     208.91 GFLOPS
    Memory bandwidth:  9.23 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.9892 ms
  Min time:     0.9196 ms
  Max time:     1.0363 ms
  Std dev:      0.0443 ms
  Performance metrics:
    Throughput:        1035180.69 images/sec
    Computational:     207.76 GFLOPS
    Memory bandwidth:  8.37 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking transposed-weight kernel with batch size 32...
Results for transposed-weight kernel with batch size 32:
  Average time: 0.1826 ms
  Min time:     0.1744 ms
  Max time:     0.1925 ms
  Std dev:      0.0076 ms
  Performance metrics:
    Throughput:        175219.70 images/sec
    Computational:     35.17 GFLOPS
    Memory bandwidth:  5.68 GB/s

Benchmarking transposed-weight kernel with batch size 64...
Results for transposed-weight kernel with batch size 64:
  Average time: 0.2865 ms
  Min time:     0.2787 ms
  Max time:     0.3023 ms
  Std dev:      0.0042 ms
  Performance metrics:
    Throughput:        223400.48 images/sec
    Computational:     44.84 GFLOPS
    Memory bandwidth:  4.44 GB/s

Benchmarking transposed-weight kernel with batch size 128...
Results for transposed-weight kernel with batch size 128:
  Average time: 0.5424 ms
  Min time:     0.5403 ms
  Max time:     0.5484 ms
  Std dev:      0.0021 ms
  Performance metrics:
    Throughput:        235977.20 images/sec
    Computational:     47.36 GFLOPS
    Memory bandwidth:  3.20 GB/s

Benchmarking transposed-weight kernel with batch size 256...
Results for transposed-weight kernel with batch size 256:
  Average time: 0.9565 ms
  Min time:     0.9531 ms
  Max time:     0.9675 ms
  Std dev:      0.0030 ms
  Performance metrics:
    Throughput:        267641.94 images/sec
    Computational:     53.72 GFLOPS
    Memory bandwidth:  2.79 GB/s

Benchmarking transposed-weight kernel with batch size 512...
Results for transposed-weight kernel with batch size 512:
  Average time: 1.8463 ms
  Min time:     1.7381 ms
  Max time:     1.8572 ms
  Std dev:      0.0154 ms
  Performance metrics:
    Throughput:        277312.00 images/sec
    Computational:     55.66 GFLOPS
    Memory bandwidth:  2.46 GB/s

Benchmarking transposed-weight kernel with batch size 1024...
Results for transposed-weight kernel with batch size 1024:
  Average time: 3.4287 ms
  Min time:     3.4260 ms
  Max time:     3.4329 ms
  Std dev:      0.0016 ms
  Performance metrics:
    Throughput:        298659.25 images/sec
    Computational:     59.94 GFLOPS
    Memory bandwidth:  2.41 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_\ batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch
Compiling benchmark 'hidden_layer_kernel_batch'...
Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Transposed kernel: FAIL - max diff: 3.305704e+01 at index 474 (batch=3, neuron=90)
    Values at failure point: original=33.057039, transposed=0.000000

Diagnostic for transposed weights kernel:
Sampling 5 random points to compare values:
  Sample 0 (batch=28, neuron=70): original=6.169207, transposed=6.169207, diff=0.000000e+00
  Sample 1 (batch=8, neuron=100): original=13.357563, transposed=13.357563, diff=0.000000e+00
  Sample 2 (batch=0, neuron=49): original=6.720715, transposed=6.720715, diff=0.000000e+00
  Sample 3 (batch=22, neuron=41): original=0.000000, transposed=0.000000, diff=0.000000e+00
  Sample 4 (batch=10, neuron=100): original=15.112679, transposed=15.112679, diff=0.000000e+00
ERROR: One or more optimized kernels produce incorrect results.
Continuing with benchmarks, but results may not be accurate.

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.1139 ms
  Min time:     0.1125 ms
  Max time:     0.1161 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        280953.31 images/sec
    Computational:     56.39 GFLOPS
    Memory bandwidth:  9.11 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.1154 ms
  Min time:     0.1130 ms
  Max time:     0.1180 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        554503.44 images/sec
    Computational:     111.29 GFLOPS
    Memory bandwidth:  11.01 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.2178 ms
  Min time:     0.2160 ms
  Max time:     0.2304 ms
  Std dev:      0.0014 ms
  Performance metrics:
    Throughput:        587650.25 images/sec
    Computational:     117.94 GFLOPS
    Memory bandwidth:  7.98 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.4281 ms
  Min time:     0.4265 ms
  Max time:     0.4296 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        598014.56 images/sec
    Computational:     120.02 GFLOPS
    Memory bandwidth:  6.24 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.7360 ms
  Min time:     0.5250 ms
  Max time:     0.7536 ms
  Std dev:      0.0543 ms
  Performance metrics:
    Throughput:        695650.12 images/sec
    Computational:     139.62 GFLOPS
    Memory bandwidth:  6.17 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.9886 ms
  Min time:     0.8845 ms
  Max time:     1.0460 ms
  Std dev:      0.0629 ms
  Performance metrics:
    Throughput:        1035832.50 images/sec
    Computational:     207.90 GFLOPS
    Memory bandwidth:  8.37 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0883 ms
  Min time:     0.0868 ms
  Max time:     0.0900 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        362602.50 images/sec
    Computational:     72.78 GFLOPS
    Memory bandwidth:  11.75 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0873 ms
  Min time:     0.0811 ms
  Max time:     0.0924 ms
  Std dev:      0.0035 ms
  Performance metrics:
    Throughput:        733487.19 images/sec
    Computational:     147.21 GFLOPS
    Memory bandwidth:  14.56 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.1471 ms
  Min time:     0.1425 ms
  Max time:     0.1504 ms
  Std dev:      0.0027 ms
  Performance metrics:
    Throughput:        870098.38 images/sec
    Computational:     174.63 GFLOPS
    Memory bandwidth:  11.81 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.2767 ms
  Min time:     0.2708 ms
  Max time:     0.2841 ms
  Std dev:      0.0029 ms
  Performance metrics:
    Throughput:        925268.62 images/sec
    Computational:     185.71 GFLOPS
    Memory bandwidth:  9.66 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.4926 ms
  Min time:     0.4753 ms
  Max time:     0.5325 ms
  Std dev:      0.0180 ms
  Performance metrics:
    Throughput:        1039481.44 images/sec
    Computational:     208.63 GFLOPS
    Memory bandwidth:  9.22 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.9887 ms
  Min time:     0.9114 ms
  Max time:     1.0363 ms
  Std dev:      0.0502 ms
  Performance metrics:
    Throughput:        1035712.56 images/sec
    Computational:     207.87 GFLOPS
    Memory bandwidth:  8.37 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking transposed-weight kernel with batch size 32...
Results for transposed-weight kernel with batch size 32:
  Average time: 0.1824 ms
  Min time:     0.1788 ms
  Max time:     0.1917 ms
  Std dev:      0.0037 ms
  Performance metrics:
    Throughput:        175413.67 images/sec
    Computational:     35.21 GFLOPS
    Memory bandwidth:  5.69 GB/s

Benchmarking transposed-weight kernel with batch size 64...
Results for transposed-weight kernel with batch size 64:
  Average time: 0.2915 ms
  Min time:     0.2843 ms
  Max time:     0.2970 ms
  Std dev:      0.0042 ms
  Performance metrics:
    Throughput:        219560.14 images/sec
    Computational:     44.07 GFLOPS
    Memory bandwidth:  4.36 GB/s

Benchmarking transposed-weight kernel with batch size 128...
Results for transposed-weight kernel with batch size 128:
  Average time: 0.5455 ms
  Min time:     0.5404 ms
  Max time:     0.5540 ms
  Std dev:      0.0036 ms
  Performance metrics:
    Throughput:        234654.50 images/sec
    Computational:     47.10 GFLOPS
    Memory bandwidth:  3.19 GB/s

Benchmarking transposed-weight kernel with batch size 256...
Results for transposed-weight kernel with batch size 256:
  Average time: 0.9570 ms
  Min time:     0.9471 ms
  Max time:     0.9644 ms
  Std dev:      0.0040 ms
  Performance metrics:
    Throughput:        267505.88 images/sec
    Computational:     53.69 GFLOPS
    Memory bandwidth:  2.79 GB/s

Benchmarking transposed-weight kernel with batch size 512...
Results for transposed-weight kernel with batch size 512:
  Average time: 1.8377 ms
  Min time:     1.7354 ms
  Max time:     1.8594 ms
  Std dev:      0.0318 ms
  Performance metrics:
    Throughput:        278610.16 images/sec
    Computational:     55.92 GFLOPS
    Memory bandwidth:  2.47 GB/s

Benchmarking transposed-weight kernel with batch size 1024...
Results for transposed-weight kernel with batch size 1024:
  Average time: 3.4300 ms
  Min time:     3.4251 ms
  Max time:     3.4345 ms
  Std dev:      0.0023 ms
  Performance metrics:
    Throughput:        298542.47 images/sec
    Computational:     59.92 GFLOPS
    Memory bandwidth:  2.41 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_\ batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch
Compiling benchmark 'hidden_layer_kernel_batch'...
Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.1560 ms
  Min time:     0.1553 ms
  Max time:     0.1577 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        205081.56 images/sec
    Computational:     41.16 GFLOPS
    Memory bandwidth:  6.65 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.1565 ms
  Min time:     0.1556 ms
  Max time:     0.1659 ms
  Std dev:      0.0012 ms
  Performance metrics:
    Throughput:        408853.28 images/sec
    Computational:     82.06 GFLOPS
    Memory bandwidth:  8.12 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.3023 ms
  Min time:     0.3010 ms
  Max time:     0.3044 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        423385.72 images/sec
    Computational:     84.98 GFLOPS
    Memory bandwidth:  5.75 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.5248 ms
  Min time:     0.4465 ms
  Max time:     0.6033 ms
  Std dev:      0.0765 ms
  Performance metrics:
    Throughput:        487845.88 images/sec
    Computational:     97.91 GFLOPS
    Memory bandwidth:  5.09 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.7858 ms
  Min time:     0.7844 ms
  Max time:     0.7879 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        651590.00 images/sec
    Computational:     130.78 GFLOPS
    Memory bandwidth:  5.78 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 1.1142 ms
  Min time:     0.9305 ms
  Max time:     1.4541 ms
  Std dev:      0.2245 ms
  Performance metrics:
    Throughput:        919061.56 images/sec
    Computational:     184.46 GFLOPS
    Memory bandwidth:  7.43 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0892 ms
  Min time:     0.0881 ms
  Max time:     0.0901 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        358640.12 images/sec
    Computational:     71.98 GFLOPS
    Memory bandwidth:  11.63 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0842 ms
  Min time:     0.0835 ms
  Max time:     0.0853 ms
  Std dev:      0.0004 ms
  Performance metrics:
    Throughput:        760537.12 images/sec
    Computational:     152.64 GFLOPS
    Memory bandwidth:  15.10 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.1449 ms
  Min time:     0.1435 ms
  Max time:     0.1531 ms
  Std dev:      0.0013 ms
  Performance metrics:
    Throughput:        883132.94 images/sec
    Computational:     177.25 GFLOPS
    Memory bandwidth:  11.99 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.2760 ms
  Min time:     0.2744 ms
  Max time:     0.2780 ms
  Std dev:      0.0010 ms
  Performance metrics:
    Throughput:        927569.69 images/sec
    Computational:     186.17 GFLOPS
    Memory bandwidth:  9.68 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.4937 ms
  Min time:     0.4761 ms
  Max time:     0.5235 ms
  Std dev:      0.0183 ms
  Performance metrics:
    Throughput:        1037072.75 images/sec
    Computational:     208.14 GFLOPS
    Memory bandwidth:  9.19 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.9898 ms
  Min time:     0.9298 ms
  Max time:     1.0351 ms
  Std dev:      0.0392 ms
  Performance metrics:
    Throughput:        1034511.88 images/sec
    Computational:     207.63 GFLOPS
    Memory bandwidth:  8.36 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced-optimized kernel with batch size 32...
Results for advanced-optimized kernel with batch size 32:
  Average time: 0.0938 ms
  Min time:     0.0923 ms
  Max time:     0.0952 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        341201.44 images/sec
    Computational:     68.48 GFLOPS
    Memory bandwidth:  11.06 GB/s

Benchmarking advanced-optimized kernel with batch size 64...
Results for advanced-optimized kernel with batch size 64:
  Average time: 0.0876 ms
  Min time:     0.0861 ms
  Max time:     0.0884 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        730986.12 images/sec
    Computational:     146.71 GFLOPS
    Memory bandwidth:  14.51 GB/s

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.1421 ms
  Min time:     0.1397 ms
  Max time:     0.1475 ms
  Std dev:      0.0022 ms
  Performance metrics:
    Throughput:        900752.88 images/sec
    Computational:     180.78 GFLOPS
    Memory bandwidth:  12.23 GB/s

Benchmarking advanced-optimized kernel with batch size 256...
Results for advanced-optimized kernel with batch size 256:
  Average time: 0.2746 ms
  Min time:     0.2714 ms
  Max time:     0.2764 ms
  Std dev:      0.0013 ms
  Performance metrics:
    Throughput:        932232.44 images/sec
    Computational:     187.10 GFLOPS
    Memory bandwidth:  9.73 GB/s

Benchmarking advanced-optimized kernel with batch size 512...
Results for advanced-optimized kernel with batch size 512:
  Average time: 0.4894 ms
  Min time:     0.4727 ms
  Max time:     0.5192 ms
  Std dev:      0.0162 ms
  Performance metrics:
    Throughput:        1046094.31 images/sec
    Computational:     209.96 GFLOPS
    Memory bandwidth:  9.27 GB/s

Benchmarking advanced-optimized kernel with batch size 1024...
Results for advanced-optimized kernel with batch size 1024:
  Average time: 0.9696 ms
  Min time:     0.8925 ms
  Max time:     1.0136 ms
  Std dev:      0.0450 ms
  Performance metrics:
    Throughput:        1056148.12 images/sec
    Computational:     211.97 GFLOPS
    Memory bandwidth:  8.53 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch > log_advanced
<sh hidden_layer_kernel_batch > log_advanced                         <sh hidden_layer_kernel_batch > log_advanced
hidden_layer_kernel_batch.cu(422): warning #546-D: transfer of control bypasses initialization of:
            variable "total_hidden_neurons" (declared at line 427)
      switch (kernel_type) {
      ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(422): warning #546-D: transfer of control bypasses initialization of:
            variable "total_hidden_neurons" (declared at line 427)
      switch (kernel_type) {
      ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu: In function 'void benchmark_batch_size(int, int)':
hidden_layer_kernel_batch.cu:434:6: error: jump to case label
  434 |         case 3: // Tiled
      |      ^
hidden_layer_kernel_batch.cu:427:5: note:   crosses initialization of 'int total_hidden_neurons'
  427 |             int total_hidden_neurons = batch_size * HIDDEN_NODES;
      |     ^       ~~~~~~~~~~~~
hidden_layer_kernel_batch.cu:442:6: error: jump to case label
  442 |         case 4: // Warp-cooperative
      |      ^
hidden_layer_kernel_batch.cu:427:5: note:   crosses initialization of 'int total_hidden_neurons'
  427 |             int total_hidden_neurons = batch_size * HIDDEN_NODES;
      |     ^       ~~~~~~~~~~~~
<istory                                                              ubuntu@VM-0-11-ubuntu:~/kiv/18646_group 
 1999  2025-04-28 02:34:49 touch run.sh
 2000  2025-04-28 02:37:03 chmod +x run.sh 
 2001  2025-04-28 02:37:37 export PS1="\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ "
 2002  2025-04-28 02:37:40 clear
 2003  2025-04-28 02:37:42 ./benchmark/run.sh hidden_layer_kernel_batch
 2004  2025-04-28 02:37:56 cd benchmark
 2005  2025-04-28 02:38:01 run.sh hidden_layer_kernel_batch
 2006  2025-04-28 02:38:04 ./run.sh hidden_layer_kernel_batch
 2007  2025-04-28 02:51:13 ./run.sh hidden_layer_kernel_batch > log_advanced
 2008  2025-04-28 02:56:22 history | tail -n 10
</run.sh hidden_layer_kernel_                                        </run.sh hidden_layer_kernel_batch &> bench.log
<n.sh hidden_layer_kernel_batch &> bench.log                         <n.sh hidden_layer_kernel_batch46_group .log
Compiling benchmark 'hidden_layer_kernel_batch'...
Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS
  Tiled kernel: PASS
  Warp kernel: FAIL - max diff: 3.014859e+01 at index 574 (batch=4, neuron=62)
    Values at failure point: original=13.439476, Warp=43.588061
ERROR: One or more optimized kernels produce incorrect results.
Continuing with benchmarks, but results may not be accurate.

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.1174 ms
  Min time:     0.1157 ms
  Max time:     0.1197 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        272579.03 images/sec
    Computational:     54.71 GFLOPS
    Memory bandwidth:  8.84 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.1188 ms
  Min time:     0.1167 ms
  Max time:     0.1207 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        538666.81 images/sec
    Computational:     108.11 GFLOPS
    Memory bandwidth:  10.70 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.2240 ms
  Min time:     0.2232 ms
  Max time:     0.2253 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        571476.75 images/sec
    Computational:     114.70 GFLOPS
    Memory bandwidth:  7.76 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.4412 ms
  Min time:     0.4403 ms
  Max time:     0.4424 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        580283.38 images/sec
    Computational:     116.47 GFLOPS
    Memory bandwidth:  6.06 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.5879 ms
  Min time:     0.4898 ms
  Max time:     0.7759 ms
  Std dev:      0.1309 ms
  Performance metrics:
    Throughput:        870929.44 images/sec
    Computational:     174.80 GFLOPS
    Memory bandwidth:  7.72 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.9898 ms
  Min time:     0.8740 ms
  Max time:     1.0526 ms
  Std dev:      0.0699 ms
  Performance metrics:
    Throughput:        1034580.81 images/sec
    Computational:     207.64 GFLOPS
    Memory bandwidth:  8.36 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0883 ms
  Min time:     0.0868 ms
  Max time:     0.0900 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        362423.75 images/sec
    Computational:     72.74 GFLOPS
    Memory bandwidth:  11.75 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0897 ms
  Min time:     0.0838 ms
  Max time:     0.0931 ms
  Std dev:      0.0029 ms
  Performance metrics:
    Throughput:        713811.31 images/sec
    Computational:     143.26 GFLOPS
    Memory bandwidth:  14.17 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.1491 ms
  Min time:     0.1442 ms
  Max time:     0.1525 ms
  Std dev:      0.0027 ms
  Performance metrics:
    Throughput:        858715.56 images/sec
    Computational:     172.35 GFLOPS
    Memory bandwidth:  11.66 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.2770 ms
  Min time:     0.2707 ms
  Max time:     0.2873 ms
  Std dev:      0.0030 ms
  Performance metrics:
    Throughput:        924199.62 images/sec
    Computational:     185.49 GFLOPS
    Memory bandwidth:  9.64 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.4945 ms
  Min time:     0.4754 ms
  Max time:     0.5294 ms
  Std dev:      0.0179 ms
  Performance metrics:
    Throughput:        1035420.25 images/sec
    Computational:     207.81 GFLOPS
    Memory bandwidth:  9.18 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.9849 ms
  Min time:     0.8926 ms
  Max time:     1.0354 ms
  Std dev:      0.0564 ms
  Performance metrics:
    Throughput:        1039744.62 images/sec
    Computational:     208.68 GFLOPS
    Memory bandwidth:  8.40 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced-optimized kernel with batch size 32...
Results for advanced-optimized kernel with batch size 32:
  Average time: 0.0935 ms
  Min time:     0.0922 ms
  Max time:     0.0964 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        342113.09 images/sec
    Computational:     68.66 GFLOPS
    Memory bandwidth:  11.09 GB/s

Benchmarking advanced-optimized kernel with batch size 64...
Results for advanced-optimized kernel with batch size 64:
  Average time: 0.0932 ms
  Min time:     0.0864 ms
  Max time:     0.0962 ms
  Std dev:      0.0033 ms
  Performance metrics:
    Throughput:        686511.56 images/sec
    Computational:     137.79 GFLOPS
    Memory bandwidth:  13.63 GB/s

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.1451 ms
  Min time:     0.1398 ms
  Max time:     0.1485 ms
  Std dev:      0.0027 ms
  Performance metrics:
    Throughput:        881857.56 images/sec
    Computational:     176.99 GFLOPS
    Memory bandwidth:  11.97 GB/s

Benchmarking advanced-optimized kernel with batch size 256...
Results for advanced-optimized kernel with batch size 256:
  Average time: 0.2767 ms
  Min time:     0.2724 ms
  Max time:     0.2821 ms
  Std dev:      0.0024 ms
  Performance metrics:
    Throughput:        925354.00 images/sec
    Computational:     185.72 GFLOPS
    Memory bandwidth:  9.66 GB/s

Benchmarking advanced-optimized kernel with batch size 512...
Results for advanced-optimized kernel with batch size 512:
  Average time: 0.4888 ms
  Min time:     0.4714 ms
  Max time:     0.5242 ms
  Std dev:      0.0167 ms
  Performance metrics:
    Throughput:        1047457.25 images/sec
    Computational:     210.23 GFLOPS
    Memory bandwidth:  9.29 GB/s

Benchmarking advanced-optimized kernel with batch size 1024...
Results for advanced-optimized kernel with batch size 1024:
  Average time: 0.9736 ms
  Min time:     0.9114 ms
  Max time:     1.0137 ms
  Std dev:      0.0429 ms
  Performance metrics:
    Throughput:        1051800.88 images/sec
    Computational:     211.10 GFLOPS
    Memory bandwidth:  8.50 GB/s

===== BENCHMARKING KERNEL TYPE 3 =====

Benchmarking tiled kernel with batch size 32...
Results for tiled kernel with batch size 32:
  Average time: 0.0812 ms
  Min time:     0.0799 ms
  Max time:     0.0819 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        394043.59 images/sec
    Computational:     79.09 GFLOPS
    Memory bandwidth:  12.77 GB/s

Benchmarking tiled kernel with batch size 64...
Results for tiled kernel with batch size 64:
  Average time: 0.1462 ms
  Min time:     0.1410 ms
  Max time:     0.1487 ms
  Std dev:      0.0014 ms
  Performance metrics:
    Throughput:        437831.28 images/sec
    Computational:     87.87 GFLOPS
    Memory bandwidth:  8.69 GB/s

Benchmarking tiled kernel with batch size 128...
Results for tiled kernel with batch size 128:
  Average time: 0.2737 ms
  Min time:     0.2703 ms
  Max time:     0.2775 ms
  Std dev:      0.0023 ms
  Performance metrics:
    Throughput:        467727.88 images/sec
    Computational:     93.87 GFLOPS
    Memory bandwidth:  6.35 GB/s

Benchmarking tiled kernel with batch size 256...
Results for tiled kernel with batch size 256:
  Average time: 0.5292 ms
  Min time:     0.5263 ms
  Max time:     0.5344 ms
  Std dev:      0.0025 ms
  Performance metrics:
    Throughput:        483734.97 images/sec
    Computational:     97.09 GFLOPS
    Memory bandwidth:  5.05 GB/s

Benchmarking tiled kernel with batch size 512...
Results for tiled kernel with batch size 512:
  Average time: 1.1082 ms
  Min time:     1.0998 ms
  Max time:     1.1172 ms
  Std dev:      0.0035 ms
  Performance metrics:
    Throughput:        462026.75 images/sec
    Computational:     92.73 GFLOPS
    Memory bandwidth:  4.10 GB/s

Benchmarking tiled kernel with batch size 1024...
Results for tiled kernel with batch size 1024:
  Average time: 2.1922 ms
  Min time:     2.1896 ms
  Max time:     2.1964 ms
  Std dev:      0.0012 ms
  Performance metrics:
    Throughput:        467108.09 images/sec
    Computational:     93.75 GFLOPS
    Memory bandwidth:  3.77 GB/s

===== BENCHMARKING KERNEL TYPE 4 =====

Benchmarking warp-cooperative kernel with batch size 32...
Results for warp-cooperative kernel with batch size 32:
  Average time: 0.2040 ms
  Min time:     0.2027 ms
  Max time:     0.2069 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        156882.45 images/sec
    Computational:     31.49 GFLOPS
    Memory bandwidth:  5.09 GB/s

Benchmarking warp-cooperative kernel with batch size 64...
Results for warp-cooperative kernel with batch size 64:
  Average time: 0.4089 ms
  Min time:     0.4049 ms
  Max time:     0.4196 ms
  Std dev:      0.0036 ms
  Performance metrics:
    Throughput:        156528.70 images/sec
    Computational:     31.42 GFLOPS
    Memory bandwidth:  3.11 GB/s

Benchmarking warp-cooperative kernel with batch size 128...
Results for warp-cooperative kernel with batch size 128:
  Average time: 0.7584 ms
  Min time:     0.7376 ms
  Max time:     0.7718 ms
  Std dev:      0.0124 ms
  Performance metrics:
    Throughput:        168787.42 images/sec
    Computational:     33.88 GFLOPS
    Memory bandwidth:  2.29 GB/s

Benchmarking warp-cooperative kernel with batch size 256...
Results for warp-cooperative kernel with batch size 256:
  Average time: 1.4363 ms
  Min time:     1.3775 ms
  Max time:     1.4746 ms
  Std dev:      0.0238 ms
  Performance metrics:
    Throughput:        178240.72 images/sec
    Computational:     35.77 GFLOPS
    Memory bandwidth:  1.86 GB/s

Benchmarking warp-cooperative kernel with batch size 512...
Results for warp-cooperative kernel with batch size 512:
  Average time: 2.8467 ms
  Min time:     2.7256 ms
  Max time:     2.8978 ms
  Std dev:      0.0377 ms
  Performance metrics:
    Throughput:        179860.53 images/sec
    Computational:     36.10 GFLOPS
    Memory bandwidth:  1.59 GB/s

Benchmarking warp-cooperative kernel with batch size 1024...
Results for warp-cooperative kernel with batch size 1024:
  Average time: 5.8001 ms
  Min time:     5.7128 ms
  Max time:     5.9750 ms
  Std dev:      0.0737 ms
  Performance metrics:
    Throughput:        176547.59 images/sec
    Computational:     35.43 GFLOPS
    Memory bandwidth:  1.43 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch &> bench.log
<n.sh hidden_layer_kernel_batch &> bench.log                         ubuntu@VM-0-11-ubuntu:~/kiv/18646_group             
Compiling benchmark 'hidden_layer_kernel_batch'...
Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
CUDA Error: Synchronize after tiled kernel - an illegal memory access was encountered
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch
Compiling benchmark 'hidden_layer_kernel_batch'...
Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
CUDA Error: Synchronize after tiled kernel - an illegal memory access was encountered
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.1174 ms
  Min time:     0.1152 ms
  Max time:     0.1189 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        272550.03 images/sec
    Computational:     54.70 GFLOPS
    Memory bandwidth:  8.83 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.1188 ms
  Min time:     0.1169 ms
  Max time:     0.1209 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        538729.25 images/sec
    Computational:     108.13 GFLOPS
    Memory bandwidth:  10.70 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.2241 ms
  Min time:     0.2232 ms
  Max time:     0.2263 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        571055.88 images/sec
    Computational:     114.61 GFLOPS
    Memory bandwidth:  7.75 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.4410 ms
  Min time:     0.4403 ms
  Max time:     0.4424 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        580453.69 images/sec
    Computational:     116.50 GFLOPS
    Memory bandwidth:  6.06 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.7194 ms
  Min time:     0.5158 ms
  Max time:     0.7761 ms
  Std dev:      0.1045 ms
  Performance metrics:
    Throughput:        711753.38 images/sec
    Computational:     142.85 GFLOPS
    Memory bandwidth:  6.31 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.9881 ms
  Min time:     0.8848 ms
  Max time:     1.0395 ms
  Std dev:      0.0592 ms
  Performance metrics:
    Throughput:        1036301.75 images/sec
    Computational:     207.99 GFLOPS
    Memory bandwidth:  8.37 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0877 ms
  Min time:     0.0862 ms
  Max time:     0.0890 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        364824.94 images/sec
    Computational:     73.22 GFLOPS
    Memory bandwidth:  11.83 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0824 ms
  Min time:     0.0795 ms
  Max time:     0.0894 ms
  Std dev:      0.0035 ms
  Performance metrics:
    Throughput:        776614.44 images/sec
    Computational:     155.87 GFLOPS
    Memory bandwidth:  15.42 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.1445 ms
  Min time:     0.1413 ms
  Max time:     0.1490 ms
  Std dev:      0.0028 ms
  Performance metrics:
    Throughput:        886050.00 images/sec
    Computational:     177.83 GFLOPS
    Memory bandwidth:  12.03 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.2730 ms
  Min time:     0.2700 ms
  Max time:     0.2796 ms
  Std dev:      0.0023 ms
  Performance metrics:
    Throughput:        937806.81 images/sec
    Computational:     188.22 GFLOPS
    Memory bandwidth:  9.79 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.4936 ms
  Min time:     0.4710 ms
  Max time:     0.5282 ms
  Std dev:      0.0201 ms
  Performance metrics:
    Throughput:        1037228.19 images/sec
    Computational:     208.18 GFLOPS
    Memory bandwidth:  9.20 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.9860 ms
  Min time:     0.8834 ms
  Max time:     1.0376 ms
  Std dev:      0.0618 ms
  Performance metrics:
    Throughput:        1038572.25 images/sec
    Computational:     208.45 GFLOPS
    Memory bandwidth:  8.39 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced-optimized kernel with batch size 32...
Results for advanced-optimized kernel with batch size 32:
  Average time: 0.0833 ms
  Min time:     0.0819 ms
  Max time:     0.0851 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        384273.91 images/sec
    Computational:     77.13 GFLOPS
    Memory bandwidth:  12.46 GB/s

Benchmarking advanced-optimized kernel with batch size 64...
Results for advanced-optimized kernel with batch size 64:
  Average time: 0.0774 ms
  Min time:     0.0763 ms
  Max time:     0.0788 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        826500.75 images/sec
    Computational:     165.88 GFLOPS
    Memory bandwidth:  16.41 GB/s

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.1414 ms
  Min time:     0.1399 ms
  Max time:     0.1426 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        904918.06 images/sec
    Computational:     181.62 GFLOPS
    Memory bandwidth:  12.29 GB/s

Benchmarking advanced-optimized kernel with batch size 256...
Results for advanced-optimized kernel with batch size 256:
  Average time: 0.2694 ms
  Min time:     0.2662 ms
  Max time:     0.2725 ms
  Std dev:      0.0024 ms
  Performance metrics:
    Throughput:        950106.50 images/sec
    Computational:     190.69 GFLOPS
    Memory bandwidth:  9.92 GB/s

Benchmarking advanced-optimized kernel with batch size 512...
Results for advanced-optimized kernel with batch size 512:
  Average time: 0.4871 ms
  Min time:     0.4672 ms
  Max time:     0.5179 ms
  Std dev:      0.0201 ms
  Performance metrics:
    Throughput:        1051097.00 images/sec
    Computational:     210.96 GFLOPS
    Memory bandwidth:  9.32 GB/s

Benchmarking advanced-optimized kernel with batch size 1024...
Results for advanced-optimized kernel with batch size 1024:
  Average time: 0.9906 ms
  Min time:     0.9174 ms
  Max time:     1.0379 ms
  Std dev:      0.0438 ms
  Performance metrics:
    Throughput:        1033720.56 images/sec
    Computational:     207.47 GFLOPS
    Memory bandwidth:  8.35 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.1417 ms
  Min time:     0.1399 ms
  Max time:     0.1454 ms
  Std dev:      0.0009 ms
  Performance metrics:
    Throughput:        225907.05 images/sec
    Computational:     45.34 GFLOPS
    Memory bandwidth:  7.32 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.1416 ms
  Min time:     0.1399 ms
  Max time:     0.1435 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        452089.84 images/sec
    Computational:     90.74 GFLOPS
    Memory bandwidth:  8.98 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.2729 ms
  Min time:     0.2712 ms
  Max time:     0.2745 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        469023.41 images/sec
    Computational:     94.13 GFLOPS
    Memory bandwidth:  6.37 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.5411 ms
  Min time:     0.5390 ms
  Max time:     0.5427 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        473093.31 images/sec
    Computational:     94.95 GFLOPS
    Memory bandwidth:  4.94 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.8907 ms
  Min time:     0.5261 ms
  Max time:     0.9475 ms
  Std dev:      0.1340 ms
  Performance metrics:
    Throughput:        574809.50 images/sec
    Computational:     115.37 GFLOPS
    Memory bandwidth:  5.10 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.9906 ms
  Min time:     0.9034 ms
  Max time:     1.0400 ms
  Std dev:      0.0536 ms
  Performance metrics:
    Throughput:        1033709.81 images/sec
    Computational:     207.47 GFLOPS
    Memory bandwidth:  8.35 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0877 ms
  Min time:     0.0866 ms
  Max time:     0.0891 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        364803.75 images/sec
    Computational:     73.22 GFLOPS
    Memory bandwidth:  11.83 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0813 ms
  Min time:     0.0800 ms
  Max time:     0.0822 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        787246.56 images/sec
    Computational:     158.00 GFLOPS
    Memory bandwidth:  15.63 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.1427 ms
  Min time:     0.1412 ms
  Max time:     0.1498 ms
  Std dev:      0.0022 ms
  Performance metrics:
    Throughput:        896875.12 images/sec
    Computational:     180.01 GFLOPS
    Memory bandwidth:  12.18 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.2720 ms
  Min time:     0.2700 ms
  Max time:     0.2806 ms
  Std dev:      0.0014 ms
  Performance metrics:
    Throughput:        941076.69 images/sec
    Computational:     188.88 GFLOPS
    Memory bandwidth:  9.82 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.4944 ms
  Min time:     0.4713 ms
  Max time:     0.5278 ms
  Std dev:      0.0206 ms
  Performance metrics:
    Throughput:        1035652.31 images/sec
    Computational:     207.86 GFLOPS
    Memory bandwidth:  9.18 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.9877 ms
  Min time:     0.9105 ms
  Max time:     1.0270 ms
  Std dev:      0.0430 ms
  Performance metrics:
    Throughput:        1036720.06 images/sec
    Computational:     208.07 GFLOPS
    Memory bandwidth:  8.38 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced-optimized kernel with batch size 32...
Results for advanced-optimized kernel with batch size 32:
  Average time: 0.0833 ms
  Min time:     0.0819 ms
  Max time:     0.0852 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        384355.09 images/sec
    Computational:     77.14 GFLOPS
    Memory bandwidth:  12.46 GB/s

Benchmarking advanced-optimized kernel with batch size 64...
Results for advanced-optimized kernel with batch size 64:
  Average time: 0.0796 ms
  Min time:     0.0760 ms
  Max time:     0.0854 ms
  Std dev:      0.0032 ms
  Performance metrics:
    Throughput:        804156.06 images/sec
    Computational:     161.40 GFLOPS
    Memory bandwidth:  15.97 GB/s

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.1442 ms
  Min time:     0.1403 ms
  Max time:     0.1491 ms
  Std dev:      0.0029 ms
  Performance metrics:
    Throughput:        887768.69 images/sec
    Computational:     178.18 GFLOPS
    Memory bandwidth:  12.05 GB/s

Benchmarking advanced-optimized kernel with batch size 256...
Results for advanced-optimized kernel with batch size 256:
  Average time: 0.2700 ms
  Min time:     0.2662 ms
  Max time:     0.2782 ms
  Std dev:      0.0028 ms
  Performance metrics:
    Throughput:        948231.44 images/sec
    Computational:     190.31 GFLOPS
    Memory bandwidth:  9.90 GB/s

Benchmarking advanced-optimized kernel with batch size 512...
Results for advanced-optimized kernel with batch size 512:
  Average time: 0.4903 ms
  Min time:     0.4672 ms
  Max time:     0.5283 ms
  Std dev:      0.0215 ms
  Performance metrics:
    Throughput:        1044353.62 images/sec
    Computational:     209.61 GFLOPS
    Memory bandwidth:  9.26 GB/s

Benchmarking advanced-optimized kernel with batch size 1024...
Results for advanced-optimized kernel with batch size 1024:
  Average time: 0.9847 ms
  Min time:     0.8987 ms
  Max time:     1.0394 ms
  Std dev:      0.0547 ms
  Performance metrics:
    Throughput:        1039892.56 images/sec
    Computational:     208.71 GFLOPS
    Memory bandwidth:  8.40 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(221): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
Correctness Results:
  Warp kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking 8-way-unrolled kernel with batch size 32...
Results for 8-way-unrolled kernel with batch size 32:
  Average time: 0.1157 ms
  Min time:     0.1147 ms
  Max time:     0.1173 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        276583.88 images/sec
    Computational:     55.51 GFLOPS
    Memory bandwidth:  8.97 GB/s

Benchmarking 8-way-unrolled kernel with batch size 64...
Results for 8-way-unrolled kernel with batch size 64:
  Average time: 0.1162 ms
  Min time:     0.1147 ms
  Max time:     0.1173 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        550700.12 images/sec
    Computational:     110.53 GFLOPS
    Memory bandwidth:  10.93 GB/s

Benchmarking 8-way-unrolled kernel with batch size 128...
Results for 8-way-unrolled kernel with batch size 128:
  Average time: 0.2230 ms
  Min time:     0.2216 ms
  Max time:     0.2334 ms
  Std dev:      0.0012 ms
  Performance metrics:
    Throughput:        574067.56 images/sec
    Computational:     115.22 GFLOPS
    Memory bandwidth:  7.79 GB/s

Benchmarking 8-way-unrolled kernel with batch size 256...
Results for 8-way-unrolled kernel with batch size 256:
  Average time: 0.4388 ms
  Min time:     0.4382 ms
  Max time:     0.4403 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        583361.50 images/sec
    Computational:     117.08 GFLOPS
    Memory bandwidth:  6.09 GB/s

Benchmarking 8-way-unrolled kernel with batch size 512...
Results for 8-way-unrolled kernel with batch size 512:
  Average time: 0.5990 ms
  Min time:     0.5086 ms
  Max time:     0.7721 ms
  Std dev:      0.1195 ms
  Performance metrics:
    Throughput:        854790.81 images/sec
    Computational:     171.56 GFLOPS
    Memory bandwidth:  7.58 GB/s

Benchmarking 8-way-unrolled kernel with batch size 1024...
Results for 8-way-unrolled kernel with batch size 1024:
  Average time: 0.9770 ms
  Min time:     0.8806 ms
  Max time:     1.0323 ms
  Std dev:      0.0628 ms
  Performance metrics:
    Throughput:        1048088.50 images/sec
    Computational:     210.36 GFLOPS
    Memory bandwidth:  8.47 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking warp-cooperative kernel with batch size 32...
Results for warp-cooperative kernel with batch size 32:
  Average time: 0.1974 ms
  Min time:     0.1925 ms
  Max time:     0.2080 ms
  Std dev:      0.0031 ms
  Performance metrics:
    Throughput:        162100.61 images/sec
    Computational:     32.53 GFLOPS
    Memory bandwidth:  5.25 GB/s

Benchmarking warp-cooperative kernel with batch size 64...
Results for warp-cooperative kernel with batch size 64:
  Average time: 0.3498 ms
  Min time:     0.3418 ms
  Max time:     0.3600 ms
  Std dev:      0.0057 ms
  Performance metrics:
    Throughput:        182981.91 images/sec
    Computational:     36.73 GFLOPS
    Memory bandwidth:  3.63 GB/s

Benchmarking warp-cooperative kernel with batch size 128...
Results for warp-cooperative kernel with batch size 128:
  Average time: 0.6619 ms
  Min time:     0.6558 ms
  Max time:     0.6759 ms
  Std dev:      0.0040 ms
  Performance metrics:
    Throughput:        193375.36 images/sec
    Computational:     38.81 GFLOPS
    Memory bandwidth:  2.63 GB/s

Benchmarking warp-cooperative kernel with batch size 256...
Results for warp-cooperative kernel with batch size 256:
  Average time: 1.2948 ms
  Min time:     1.2806 ms
  Max time:     1.3196 ms
  Std dev:      0.0067 ms
  Performance metrics:
    Throughput:        197715.95 images/sec
    Computational:     39.68 GFLOPS
    Memory bandwidth:  2.06 GB/s

Benchmarking warp-cooperative kernel with batch size 512...
Results for warp-cooperative kernel with batch size 512:
  Average time: 2.9202 ms
  Min time:     2.9156 ms
  Max time:     2.9248 ms
  Std dev:      0.0019 ms
  Performance metrics:
    Throughput:        175328.97 images/sec
    Computational:     35.19 GFLOPS
    Memory bandwidth:  1.55 GB/s

Benchmarking warp-cooperative kernel with batch size 1024...
Results for warp-cooperative kernel with batch size 1024:
  Average time: 5.8391 ms
  Min time:     5.8310 ms
  Max time:     5.8456 ms
  Std dev:      0.0031 ms
  Performance metrics:
    Throughput:        175369.48 images/sec
    Computational:     35.20 GFLOPS
    Memory bandwidth:  1.42 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(221): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
Correctness Results:
  Warp kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking 8-way-unrolled kernel with batch size 32...
Results for 8-way-unrolled kernel with batch size 32:
  Average time: 0.1868 ms
  Min time:     0.1862 ms
  Max time:     0.1884 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        171288.88 images/sec
    Computational:     34.38 GFLOPS
    Memory bandwidth:  5.55 GB/s

Benchmarking 8-way-unrolled kernel with batch size 64...
Results for 8-way-unrolled kernel with batch size 64:
  Average time: 0.1871 ms
  Min time:     0.1861 ms
  Max time:     0.1884 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        342115.41 images/sec
    Computational:     68.66 GFLOPS
    Memory bandwidth:  6.79 GB/s

Benchmarking 8-way-unrolled kernel with batch size 128...
Results for 8-way-unrolled kernel with batch size 128:
  Average time: 0.3564 ms
  Min time:     0.3133 ms
  Max time:     0.3645 ms
  Std dev:      0.0161 ms
  Performance metrics:
    Throughput:        359174.50 images/sec
    Computational:     72.09 GFLOPS
    Memory bandwidth:  4.88 GB/s

Benchmarking 8-way-unrolled kernel with batch size 256...
Results for 8-way-unrolled kernel with batch size 256:
  Average time: 0.6277 ms
  Min time:     0.6266 ms
  Max time:     0.6303 ms
  Std dev:      0.0009 ms
  Performance metrics:
    Throughput:        407811.97 images/sec
    Computational:     81.85 GFLOPS
    Memory bandwidth:  4.26 GB/s

Benchmarking 8-way-unrolled kernel with batch size 512...
Results for 8-way-unrolled kernel with batch size 512:
  Average time: 1.0248 ms
  Min time:     0.5203 ms
  Max time:     1.0945 ms
  Std dev:      0.1789 ms
  Performance metrics:
    Throughput:        499595.81 images/sec
    Computational:     100.27 GFLOPS
    Memory bandwidth:  4.43 GB/s

Benchmarking 8-way-unrolled kernel with batch size 1024...
Results for 8-way-unrolled kernel with batch size 1024:
  Average time: 0.9836 ms
  Min time:     0.8900 ms
  Max time:     1.0323 ms
  Std dev:      0.0550 ms
  Performance metrics:
    Throughput:        1041049.12 images/sec
    Computational:     208.94 GFLOPS
    Memory bandwidth:  8.41 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking warp-cooperative kernel with batch size 32...
Results for warp-cooperative kernel with batch size 32:
  Average time: 0.2002 ms
  Min time:     0.1830 ms
  Max time:     0.2109 ms
  Std dev:      0.0084 ms
  Performance metrics:
    Throughput:        159871.56 images/sec
    Computational:     32.09 GFLOPS
    Memory bandwidth:  5.18 GB/s

Benchmarking warp-cooperative kernel with batch size 64...
Results for warp-cooperative kernel with batch size 64:
  Average time: 0.3499 ms
  Min time:     0.3367 ms
  Max time:     0.3688 ms
  Std dev:      0.0067 ms
  Performance metrics:
    Throughput:        182935.25 images/sec
    Computational:     36.72 GFLOPS
    Memory bandwidth:  3.63 GB/s

Benchmarking warp-cooperative kernel with batch size 128...
Results for warp-cooperative kernel with batch size 128:
  Average time: 0.6629 ms
  Min time:     0.6560 ms
  Max time:     0.6768 ms
  Std dev:      0.0047 ms
  Performance metrics:
    Throughput:        193104.38 images/sec
    Computational:     38.76 GFLOPS
    Memory bandwidth:  2.62 GB/s

Benchmarking warp-cooperative kernel with batch size 256...
Results for warp-cooperative kernel with batch size 256:
  Average time: 1.2966 ms
  Min time:     1.2802 ms
  Max time:     1.3169 ms
  Std dev:      0.0068 ms
  Performance metrics:
    Throughput:        197437.14 images/sec
    Computational:     39.63 GFLOPS
    Memory bandwidth:  2.06 GB/s

Benchmarking warp-cooperative kernel with batch size 512...
Results for warp-cooperative kernel with batch size 512:
  Average time: 2.9205 ms
  Min time:     2.9154 ms
  Max time:     2.9266 ms
  Std dev:      0.0023 ms
  Performance metrics:
    Throughput:        175310.47 images/sec
    Computational:     35.19 GFLOPS
    Memory bandwidth:  1.55 GB/s

Benchmarking warp-cooperative kernel with batch size 1024...
Results for warp-cooperative kernel with batch size 1024:
  Average time: 5.8402 ms
  Min time:     5.8327 ms
  Max time:     5.8638 ms
  Std dev:      0.0037 ms
  Performance metrics:
    Throughput:        175337.09 images/sec
    Computational:     35.19 GFLOPS
    Memory bandwidth:  1.42 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.1868 ms
  Min time:     0.1863 ms
  Max time:     0.1883 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        171314.06 images/sec
    Computational:     34.38 GFLOPS
    Memory bandwidth:  5.55 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.1869 ms
  Min time:     0.1853 ms
  Max time:     0.1884 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        342379.47 images/sec
    Computational:     68.72 GFLOPS
    Memory bandwidth:  6.80 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.2535 ms
  Min time:     0.2519 ms
  Max time:     0.2559 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        504954.22 images/sec
    Computational:     101.35 GFLOPS
    Memory bandwidth:  6.86 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.4972 ms
  Min time:     0.4956 ms
  Max time:     0.4991 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        514921.69 images/sec
    Computational:     103.35 GFLOPS
    Memory bandwidth:  5.37 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.8698 ms
  Min time:     0.8663 ms
  Max time:     0.8745 ms
  Std dev:      0.0020 ms
  Performance metrics:
    Throughput:        588649.50 images/sec
    Computational:     118.14 GFLOPS
    Memory bandwidth:  5.22 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.9874 ms
  Min time:     0.9037 ms
  Max time:     1.0397 ms
  Std dev:      0.0558 ms
  Performance metrics:
    Throughput:        1037046.62 images/sec
    Computational:     208.14 GFLOPS
    Memory bandwidth:  8.38 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0855 ms
  Min time:     0.0819 ms
  Max time:     0.0884 ms
  Std dev:      0.0024 ms
  Performance metrics:
    Throughput:        374301.84 images/sec
    Computational:     75.12 GFLOPS
    Memory bandwidth:  12.13 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0839 ms
  Min time:     0.0824 ms
  Max time:     0.0853 ms
  Std dev:      0.0004 ms
  Performance metrics:
    Throughput:        763131.62 images/sec
    Computational:     153.16 GFLOPS
    Memory bandwidth:  15.15 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.1447 ms
  Min time:     0.1434 ms
  Max time:     0.1459 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        884488.00 images/sec
    Computational:     177.52 GFLOPS
    Memory bandwidth:  12.01 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.2715 ms
  Min time:     0.2693 ms
  Max time:     0.2740 ms
  Std dev:      0.0012 ms
  Performance metrics:
    Throughput:        942863.75 images/sec
    Computational:     189.24 GFLOPS
    Memory bandwidth:  9.84 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.4889 ms
  Min time:     0.4711 ms
  Max time:     0.5177 ms
  Std dev:      0.0206 ms
  Performance metrics:
    Throughput:        1047331.06 images/sec
    Computational:     210.20 GFLOPS
    Memory bandwidth:  9.29 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.9906 ms
  Min time:     0.9196 ms
  Max time:     1.0374 ms
  Std dev:      0.0451 ms
  Performance metrics:
    Throughput:        1033669.19 images/sec
    Computational:     207.46 GFLOPS
    Memory bandwidth:  8.35 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced-optimized kernel with batch size 32...
Results for advanced-optimized kernel with batch size 32:
  Average time: 0.0842 ms
  Min time:     0.0823 ms
  Max time:     0.0859 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        380031.62 images/sec
    Computational:     76.27 GFLOPS
    Memory bandwidth:  12.32 GB/s

Benchmarking advanced-optimized kernel with batch size 64...
Results for advanced-optimized kernel with batch size 64:
  Average time: 0.0782 ms
  Min time:     0.0767 ms
  Max time:     0.0796 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        818377.44 images/sec
    Computational:     164.25 GFLOPS
    Memory bandwidth:  16.25 GB/s

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.1420 ms
  Min time:     0.1399 ms
  Max time:     0.1509 ms
  Std dev:      0.0022 ms
  Performance metrics:
    Throughput:        901183.19 images/sec
    Computational:     180.87 GFLOPS
    Memory bandwidth:  12.23 GB/s

Benchmarking advanced-optimized kernel with batch size 256...
Results for advanced-optimized kernel with batch size 256:
  Average time: 0.2709 ms
  Min time:     0.2685 ms
  Max time:     0.2724 ms
  Std dev:      0.0011 ms
  Performance metrics:
    Throughput:        944997.69 images/sec
    Computational:     189.66 GFLOPS
    Memory bandwidth:  9.86 GB/s

Benchmarking advanced-optimized kernel with batch size 512...
Results for advanced-optimized kernel with batch size 512:
  Average time: 0.4896 ms
  Min time:     0.4671 ms
  Max time:     0.5222 ms
  Std dev:      0.0203 ms
  Performance metrics:
    Throughput:        1045747.44 images/sec
    Computational:     209.89 GFLOPS
    Memory bandwidth:  9.27 GB/s

Benchmarking advanced-optimized kernel with batch size 1024...
Results for advanced-optimized kernel with batch size 1024:
  Average time: 0.9879 ms
  Min time:     0.9075 ms
  Max time:     1.0323 ms
  Std dev:      0.0492 ms
  Performance metrics:
    Throughput:        1036591.06 images/sec
    Computational:     208.05 GFLOPS
    Memory bandwidth:  8.38 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
</run.sh hidden_layer_kernel_batch                                   </run.sh hidden_layer_kernel_batch --kernel 2
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.3628 ms
  Min time:     0.3610 ms
  Max time:     0.3707 ms
  Std dev:      0.0010 ms
  Performance metrics:
    Throughput:        352797.50 images/sec
    Computational:     70.81 GFLOPS
    Memory bandwidth:  4.79 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 2                         <run.sh hidden_layer_kernel_batch --kernel 1
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.3408 ms
  Min time:     0.2376 ms
  Max time:     0.3639 ms
  Std dev:      0.0462 ms
  Performance metrics:
    Throughput:        375600.62 images/sec
    Computational:     75.38 GFLOPS
    Memory bandwidth:  5.10 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 1                         <run.sh hidden_layer_kernel_batch --kernel 0
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.3633 ms
  Min time:     0.3625 ms
  Max time:     0.3659 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        352278.81 images/sec
    Computational:     70.70 GFLOPS
    Memory bandwidth:  4.78 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 0                         <run.sh hidden_layer_kernel_batch --kernel 1
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.2171 ms
  Min time:     0.2155 ms
  Max time:     0.2186 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        589671.25 images/sec
    Computational:     118.35 GFLOPS
    Memory bandwidth:  8.01 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 1                         <run.sh hidden_layer_kernel_batch --kernel 1
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.2239 ms
  Min time:     0.2154 ms
  Max time:     0.3626 ms
  Std dev:      0.0295 ms
  Performance metrics:
    Throughput:        571753.44 images/sec
    Computational:     114.75 GFLOPS
    Memory bandwidth:  7.76 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 1                         <run.sh hidden_layer_kernel_batch --kernel 0
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.3633 ms
  Min time:     0.3621 ms
  Max time:     0.3646 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        352304.06 images/sec
    Computational:     70.71 GFLOPS
    Memory bandwidth:  4.78 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 0                         <run.sh hidden_layer_kernel_batch --kernel 0
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.3632 ms
  Min time:     0.3614 ms
  Max time:     0.3657 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        352454.88 images/sec
    Computational:     70.74 GFLOPS
    Memory bandwidth:  4.78 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 0                         <run.sh hidden_layer_kernel_batch --kernel 0
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.2155 ms
  Min time:     0.2136 ms
  Max time:     0.2198 ms
  Std dev:      0.0010 ms
  Performance metrics:
    Throughput:        594027.94 images/sec
    Computational:     119.22 GFLOPS
    Memory bandwidth:  8.06 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 0                         <run.sh hidden_layer_kernel_batch --kernel 1
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.2171 ms
  Min time:     0.2155 ms
  Max time:     0.2189 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        589696.50 images/sec
    Computational:     118.35 GFLOPS
    Memory bandwidth:  8.01 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 1                         <run.sh hidden_layer_kernel_batch --kernel 1
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.2429 ms
  Min time:     0.2213 ms
  Max time:     0.3630 ms
  Std dev:      0.0477 ms
  Performance metrics:
    Throughput:        526891.25 images/sec
    Computational:     105.75 GFLOPS
    Memory bandwidth:  7.15 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 1                         <run.sh hidden_layer_kernel_batch --kernel 0
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.2220 ms
  Min time:     0.2158 ms
  Max time:     0.3647 ms
  Std dev:      0.0250 ms
  Performance metrics:
    Throughput:        576671.12 images/sec
    Computational:     115.74 GFLOPS
    Memory bandwidth:  7.83 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<run.sh hidden_layer_kernel_batch --kernel 0                         <run.sh hidden_layer_kernel_batch --kernel 2
Compiling benchmark 'hidden_layer_kernel_batch'...
hidden_layer_kernel_batch.cu(266): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

hidden_layer_kernel_batch.cu(266): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

Compilation successful
Running benchmark 'hidden_layer_kernel_batch'...

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.3148 ms
  Min time:     0.3133 ms
  Max time:     0.3170 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        406546.28 images/sec
    Computational:     81.60 GFLOPS
    Memory bandwidth:  5.52 GB/s

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
Benchmark completed successfully
<istory                                                              ubuntu@VM-0-11-ubuntu:~/kiv/18646_group
 1235  2025-03-28 04:45:44 nvcc main.cu -o main -Xcompiler -fopenmp
 1829  2025-04-26 12:48:07 nvcc -o main main.c forward.c -lm
 1830  2025-04-26 12:48:59 nvcc -o main main.c forward.cu -lm
 1832  2025-04-26 12:52:53 nvcc -o main main.c forward.cu -lm
 1833  2025-04-26 12:54:52    nvcc -o main main.c forwaclear
 1835  2025-04-26 12:55:02 nvcc -o main main.c forward.cu -lm
 1837  2025-04-26 12:56:16 nvcc -o main main.c forward.cu -lm -arch=sm_75
 1842  2025-04-26 13:03:14 nvcc -o main main.c forward.cu -lm -arch=sm_75
 1848  2025-04-26 13:19:14 nvcc -o main main.c forward.cu -lm -arch=sm_75
 1882  2025-04-27 14:27:25 nvcc -o main main.c forward.cu -lm -arch=sm_70
 1890  2025-04-27 14:34:01  nvcc -o main main.c forward.cu -lm -arch=sm_70
 1892  2025-04-27 14:36:55  nvcc -o main main.c forward.cu -lm -arch=sm_70
 1903  2025-04-27 14:48:57 nvcc -o main main.c forward.cu -lm -arch=sm_70
 1905  2025-04-27 15:06:29 nvcc -o main main.c forward.cu -lm -arch=sm_70
 1907  2025-04-27 15:15:07 nvcc -o main main.c forward.cu -lm -arch=sm_70
 1908  2025-04-27 15:15:40 nvcc -o main main.c forward.cu -lm -arch=sm_75
 1910  2025-04-27 15:18:51 nvcc -o main main.c forward.cu -lm -arch=sm_75
 1912  2025-04-27 15:19:44 nvcc -o main main.c forward.cu -lm -arch=sm_75
 1924  2025-04-27 15:34:45 nvcc -o new new.c forward.cu backward.cu -lm -arch=sm_75
 1927  2025-04-27 15:38:04 nvcc -o new new.c forward.cu backward.cu -lm -arch=sm_75
 1930  2025-04-27 15:40:40 nvcc -o new new.c forward.cu backward.cu -lm -arch=sm_75
 1934  2025-04-27 15:59:17 nvcc -o new new.c forward.cu backward.cu -lm -arch=sm_75
 1938  2025-04-27 16:13:06 nvcc -o new fused_main.c forward.cu backward.cu -lm -arch=sm_75
 1940  2025-04-27 16:14:55 nvcc -o new fused_main.c  fused.cu -lm -arch=sm_75
 1942  2025-04-27 16:16:14 nvcc -o new fused_main.c  fused.cu -lm -arch=sm_75
 1945  2025-04-27 16:17:55 nvcc -o new fused_main.c  fused.cu -lm -arch=sm_75
 1947  2025-04-27 16:18:49 nvcc -o new fused_main.c  fused.cu -lm -arch=sm_75
 1949  2025-04-27 16:21:09 history | grep nvcc
 1950  2025-04-27 16:21:22 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1952  2025-04-27 16:23:28 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1954  2025-04-27 16:24:46 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1956  2025-04-27 16:35:10 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1958  2025-04-27 17:03:08 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1961  2025-04-27 17:11:59 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1963  2025-04-27 17:19:46 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1965  2025-04-27 17:26:59 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1967  2025-04-27 17:29:24 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1969  2025-04-27 17:33:21 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1971  2025-04-27 17:34:51 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1973  2025-04-27 17:44:17 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1975  2025-04-27 17:47:12 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1977  2025-04-27 17:57:21 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1979  2025-04-27 17:59:38 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1983  2025-04-28 02:06:08 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1985  2025-04-28 02:07:11 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1987  2025-04-28 02:09:23 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1989  2025-04-28 02:13:44 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1991  2025-04-28 02:15:51 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1993  2025-04-28 02:17:09 nvcc -o new fused_main.c fused.cu -lm -arch=sm_75 -Xcompiler -fopenmp
 1995  2025-04-28 02:27:03 nvcc -o kernel_benchmark kernel_benchmark.cu
 2021  2025-04-28 03:24:32 history | grep nvcc
<  ./build_output_delta.sh                                                    <  ./build_output_delta.sh
Detected GPU compute capability: sm_75
Compiling benchmark 'output_delta_kernel_batch'...
output_delta_kernel_batch.cu(75): warning #177-D: variable "s_output" was declared but never referenced
      double* s_output = shared_mem;
              ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

output_delta_kernel_batch.cu(76): warning #177-D: variable "s_targets" was declared but never referenced
      double* s_targets = shared_mem + blockDim.x;
              ^

Compilation successful
Running benchmark 'output_delta_kernel_batch'...

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Correctness: PASS
  Average time: 0.0072 ms
  Min time:     0.0061 ms
  Max time:     0.0082 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 44.68 million
    Memory bandwidth: 1.07 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Correctness: PASS
  Average time: 0.0072 ms
  Min time:     0.0061 ms
  Max time:     0.0095 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 89.15 million
    Memory bandwidth: 2.14 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Correctness: PASS
  Average time: 0.0073 ms
  Min time:     0.0061 ms
  Max time:     0.0103 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 176.32 million
    Memory bandwidth: 4.23 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Correctness: PASS
  Average time: 0.0072 ms
  Min time:     0.0062 ms
  Max time:     0.0082 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Elements/sec: 353.50 million
    Memory bandwidth: 8.48 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Correctness: PASS
  Average time: 0.0072 ms
  Min time:     0.0061 ms
  Max time:     0.0082 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 707.46 million
    Memory bandwidth: 16.98 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Correctness: PASS
  Average time: 0.0077 ms
  Min time:     0.0061 ms
  Max time:     0.0094 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 1336.62 million
    Memory bandwidth: 32.08 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking optimized kernel with batch size 32...
Results for optimized kernel with batch size 32:
  Correctness: FAIL - max diff: 1.481167e-01 at index 280
    Values at failure point: ref=0.000000, test=-0.148117
  Average time: 0.0101 ms
  Min time:     0.0086 ms
  Max time:     0.0119 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Elements/sec: 31.60 million
    Memory bandwidth: 0.76 GB/s

Benchmarking optimized kernel with batch size 64...
Results for optimized kernel with batch size 64:
  Correctness: FAIL - max diff: 1.481459e-01 at index 590
    Values at failure point: ref=0.000000, test=-0.148146
  Average time: 0.0101 ms
  Min time:     0.0085 ms
  Max time:     0.0117 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Elements/sec: 63.38 million
    Memory bandwidth: 1.52 GB/s

Benchmarking optimized kernel with batch size 128...
Results for optimized kernel with batch size 128:
  Correctness: FAIL - max diff: 1.481478e-01 at index 1187
    Values at failure point: ref=0.000000, test=-0.148148
  Average time: 0.0100 ms
  Min time:     0.0087 ms
  Max time:     0.0116 ms
  Std dev:      0.0004 ms
  Performance metrics:
    Elements/sec: 127.59 million
    Memory bandwidth: 3.06 GB/s

Benchmarking optimized kernel with batch size 256...
Results for optimized kernel with batch size 256:
  Correctness: FAIL - max diff: 1.481481e-01 at index 1240
    Values at failure point: ref=0.000000, test=0.148148
  Average time: 0.0105 ms
  Min time:     0.0092 ms
  Max time:     0.0260 ms
  Std dev:      0.0016 ms
  Performance metrics:
    Elements/sec: 242.90 million
    Memory bandwidth: 5.83 GB/s

Benchmarking optimized kernel with batch size 512...
Results for optimized kernel with batch size 512:
  Correctness: FAIL - max diff: 1.481481e-01 at index 3271
    Values at failure point: ref=0.000000, test=0.148148
  Average time: 0.0103 ms
  Min time:     0.0088 ms
  Max time:     0.0119 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Elements/sec: 499.24 million
    Memory bandwidth: 11.98 GB/s

Benchmarking optimized kernel with batch size 1024...
Results for optimized kernel with batch size 1024:
  Correctness: FAIL - max diff: 1.481481e-01 at index 9245
    Values at failure point: ref=0.000000, test=0.148148
  Average time: 0.0103 ms
  Min time:     0.0090 ms
  Max time:     0.0119 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Elements/sec: 996.26 million
    Memory bandwidth: 23.91 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced kernel with batch size 32...
Results for advanced kernel with batch size 32:
  Correctness: FAIL - max diff: 1.481477e-01 at index 310
    Values at failure point: ref=0.000000, test=-0.148148
  Average time: 0.0077 ms
  Min time:     0.0066 ms
  Max time:     0.0085 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Elements/sec: 41.42 million
    Memory bandwidth: 0.99 GB/s

Benchmarking advanced kernel with batch size 64...
Results for advanced kernel with batch size 64:
  Correctness: FAIL - max diff: 1.481477e-01 at index 269
    Values at failure point: ref=0.000000, test=-0.148148
  Average time: 0.0098 ms
  Min time:     0.0083 ms
  Max time:     0.0114 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Elements/sec: 65.55 million
    Memory bandwidth: 1.57 GB/s

Benchmarking advanced kernel with batch size 128...
Results for advanced kernel with batch size 128:
  Correctness: FAIL - max diff: 1.481481e-01 at index 888
    Values at failure point: ref=0.000000, test=0.148148
  Average time: 0.0129 ms
  Min time:     0.0122 ms
  Max time:     0.0164 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 99.31 million
    Memory bandwidth: 2.38 GB/s

Benchmarking advanced kernel with batch size 256...
Results for advanced kernel with batch size 256:
  Correctness: FAIL - max diff: 1.481481e-01 at index 1658
    Values at failure point: ref=0.000000, test=0.148148
  Average time: 0.0131 ms
  Min time:     0.0121 ms
  Max time:     0.0169 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Elements/sec: 195.95 million
    Memory bandwidth: 4.70 GB/s

Benchmarking advanced kernel with batch size 512...
Results for advanced kernel with batch size 512:
  Correctness: FAIL - max diff: 1.481481e-01 at index 993
    Values at failure point: ref=0.000000, test=0.148148
  Average time: 0.0153 ms
  Min time:     0.0143 ms
  Max time:     0.0164 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 333.82 million
    Memory bandwidth: 8.01 GB/s

Benchmarking advanced kernel with batch size 1024...
Results for advanced kernel with batch size 1024:
  Correctness: FAIL - max diff: 1.481481e-01 at index 6713
    Values at failure point: ref=0.000000, test=0.148148
  Average time: 0.0203 ms
  Min time:     0.0188 ms
  Max time:     0.0219 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Elements/sec: 504.79 million
    Memory bandwidth: 12.11 GB/s

Benchmarking complete.
Benchmark completed successfully
ubuntu@VM-0-11-ubuntu:~/kiv/18646_group_project/benchmark$    ./build_weights_kernel.sh         
Detected GPU compute capability: sm_75
Compiling benchmark 'update_weights_kernel_batch'...
update_weights_kernel_batch.cu(191): warning #177-D: variable "s_gradient_accumulator" was declared but never referenced
      double* s_gradient_accumulator = shared_mem;
              ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

update_weights_kernel_batch.cu(192): warning #177-D: variable "s_bias_gradient" was declared but never referenced
      double* s_bias_gradient = shared_mem + blockDim.x;
              ^

Compilation successful
Running benchmark 'update_weights_kernel_batch'...

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Correctness: PASS
  Average time: 0.1419 ms
  Min time:     0.1410 ms
  Max time:     0.1442 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 22653.03 million
    Memory bandwidth: 181.22 GB/s
    Batch size: 32

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Correctness: PASS
  Average time: 0.2422 ms
  Min time:     0.2404 ms
  Max time:     0.2437 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 26553.62 million
    Memory bandwidth: 212.43 GB/s
    Batch size: 64

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Correctness: PASS
  Average time: 0.4428 ms
  Min time:     0.4401 ms
  Max time:     0.4459 ms
  Std dev:      0.0010 ms
  Performance metrics:
    Elements/sec: 29044.00 million
    Memory bandwidth: 232.35 GB/s
    Batch size: 128

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 1.018317e-03 at index 96
    Bias values at failure point: ref=-0.718813, test=-0.717795
  Average time: 0.5834 ms
  Min time:     0.5816 ms
  Max time:     0.5855 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Elements/sec: 44093.75 million
    Memory bandwidth: 352.75 GB/s
    Batch size: 256

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 6.878085e-04 at index 57
    Bias values at failure point: ref=0.945871, test=0.946558
  Average time: 1.0658 ms
  Min time:     0.9837 ms
  Max time:     1.1264 ms
  Std dev:      0.0672 ms
  Performance metrics:
    Elements/sec: 48269.34 million
    Memory bandwidth: 386.15 GB/s
    Batch size: 512

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 5.170336e-04 at index 124
    Bias values at failure point: ref=-0.295074, test=-0.294557
  Average time: 1.9285 ms
  Min time:     1.9251 ms
  Max time:     1.9441 ms
  Std dev:      0.0021 ms
  Performance metrics:
    Elements/sec: 53353.83 million
    Memory bandwidth: 426.83 GB/s
    Batch size: 1024

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking optimized kernel with batch size 32...
Results for optimized kernel with batch size 32:
  Correctness: PASS
  Average time: 0.0866 ms
  Min time:     0.0848 ms
  Max time:     0.0900 ms
  Std dev:      0.0011 ms
  Performance metrics:
    Elements/sec: 37150.29 million
    Memory bandwidth: 297.20 GB/s
    Batch size: 32

Benchmarking optimized kernel with batch size 64...
Results for optimized kernel with batch size 64:
  Correctness: PASS
  Average time: 0.1453 ms
  Min time:     0.1439 ms
  Max time:     0.1473 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Elements/sec: 44264.91 million
    Memory bandwidth: 354.12 GB/s
    Batch size: 64

Benchmarking optimized kernel with batch size 128...
Results for optimized kernel with batch size 128:
  Correctness: PASS
  Average time: 0.2640 ms
  Min time:     0.2626 ms
  Max time:     0.2654 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Elements/sec: 48714.91 million
    Memory bandwidth: 389.72 GB/s
    Batch size: 128

Benchmarking optimized kernel with batch size 256...
Results for optimized kernel with batch size 256:
  Correctness: PASS
  Average time: 0.5014 ms
  Min time:     0.4997 ms
  Max time:     0.5038 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 51298.21 million
    Memory bandwidth: 410.39 GB/s
    Batch size: 256

Benchmarking optimized kernel with batch size 512...
Results for optimized kernel with batch size 512:
  Correctness: PASS
  Average time: 0.9690 ms
  Min time:     0.9668 ms
  Max time:     0.9824 ms
  Std dev:      0.0017 ms
  Performance metrics:
    Elements/sec: 53092.61 million
    Memory bandwidth: 424.74 GB/s
    Batch size: 512

Benchmarking optimized kernel with batch size 1024...
Results for optimized kernel with batch size 1024:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 4.875934e-04 at index 27
    Bias values at failure point: ref=0.409718, test=0.410206
  Average time: 1.9094 ms
  Min time:     1.9051 ms
  Max time:     1.9161 ms
  Std dev:      0.0021 ms
  Performance metrics:
    Elements/sec: 53887.71 million
    Memory bandwidth: 431.10 GB/s
    Batch size: 1024

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced kernel with batch size 32...
Results for advanced kernel with batch size 32:
  Correctness: PASS
  Average time: 0.0755 ms
  Min time:     0.0737 ms
  Max time:     0.0902 ms
  Std dev:      0.0016 ms
  Performance metrics:
    Elements/sec: 42589.98 million
    Memory bandwidth: 340.72 GB/s
    Batch size: 32

Benchmarking advanced kernel with batch size 64...
Results for advanced kernel with batch size 64:
  Correctness: PASS
  Average time: 0.1352 ms
  Min time:     0.1333 ms
  Max time:     0.1412 ms
  Std dev:      0.0017 ms
  Performance metrics:
    Elements/sec: 47552.78 million
    Memory bandwidth: 380.42 GB/s
    Batch size: 64

Benchmarking advanced kernel with batch size 128...
Results for advanced kernel with batch size 128:
  Correctness: PASS
  Average time: 0.2530 ms
  Min time:     0.2516 ms
  Max time:     0.2580 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Elements/sec: 50841.70 million
    Memory bandwidth: 406.73 GB/s
    Batch size: 128

Benchmarking advanced kernel with batch size 256...
Results for advanced kernel with batch size 256:
  Correctness: PASS
  Average time: 0.4893 ms
  Min time:     0.4876 ms
  Max time:     0.4913 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Elements/sec: 52568.22 million
    Memory bandwidth: 420.55 GB/s
    Batch size: 256

Benchmarking advanced kernel with batch size 512...
Results for advanced kernel with batch size 512:
  Correctness: PASS
  Average time: 0.9628 ms
  Min time:     0.9605 ms
  Max time:     0.9830 ms
  Std dev:      0.0029 ms
  Performance metrics:
    Elements/sec: 53432.01 million
    Memory bandwidth: 427.46 GB/s
    Batch size: 512

Benchmarking advanced kernel with batch size 1024...
Results for advanced kernel with batch size 1024:
  Correctness: PASS
  Average time: 1.9074 ms
  Min time:     1.9047 ms
  Max time:     1.9116 ms
  Std dev:      0.0013 ms
  Performance metrics:
    Elements/sec: 53943.50 million
    Memory bandwidth: 431.55 GB/s
    Batch size: 1024

Benchmarking complete.
Benchmark completed successfully
<  ./build_weights_kernel.sh > weigh                                                             ubuntu@VM-0-11-ubuntu:~/kiv/18646_group_project/benchmark$ ubuntu@VM-0-11-ubuntu:~/kiv/18646_grouubuntu@VM-0-11-ubuntu:~/kiv/18646_group_project/benchmark$ ubuntu@VM-0-11-ubuntu:~/kiv/18646_group_project/benchmark$ ubuntu@VM-0-11-ubuntu:~/kiv/18646_group_project/benchmark$ ubuntu@VM-0-11-ubuntu:~/kiv/18646_group_project/benchmark$ ubuntu@VM-0-11-ubuntu:~/kiv/18646_group_project/benchmark$ update_weights_kernel_batch.cu(191): warning #177-D: variable "s_gradient_accumulator" was declared but never referenced
      double* s_gradient_accumulator = shared_mem;
              ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

update_weights_kernel_batch.cu(192): warning #177-D: variable "s_bias_gradient" was declared but never referenced
      double* s_bias_gradient = shared_mem + blockDim.x;
              ^

<  ./build_weights_kernel.sh > weight_update.log                                                 <  ./build_weights_kernel.sh > weight_update.log
update_weights_kernel_batch.cu(191): warning #177-D: variable "s_gradient_accumulator" was declared but never referenced
      double* s_gradient_accumulator = shared_mem;
              ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

update_weights_kernel_batch.cu(192): warning #177-D: variable "s_bias_gradient" was declared but never referenced
      double* s_bias_gradient = shared_mem + blockDim.x;
              ^

                                                                       <./build_weights_kernel.sh > weight_update.log                         <./build_weights_kernel.sh > weight_update_vec
update_weights_kernel_batch.cu(102): warning #177-D: variable "s_gradient_accumulator" was declared but never referenced
      double* s_gradient_accumulator = shared_mem;
              ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

update_weights_kernel_batch.cu(103): warning #177-D: variable "s_bias_gradient" was declared but never referenced
      double* s_bias_gradient = shared_mem + blockDim.x;
              ^

update_weights_kernel_batch.cu(218): warning #177-D: variable "bias_gradient" was declared but never referenced
      double bias_gradient = 0.0;
             ^

<hmod +x build_weights_kernel.sh                                 <hmod +x build_weights_kernel.sh    
</build_weights_kernel.sh                                        </build_weights_kernel.sh           
Detected GPU compute capability: sm_75
Compiling benchmark 'update_weights_kernel_batch'...
update_weights_kernel_batch.cu(102): warning #177-D: variable "s_gradient_accumulator" was declared but never referenced
      double* s_gradient_accumulator = shared_mem;
              ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

update_weights_kernel_batch.cu(103): warning #177-D: variable "s_bias_gradient" was declared but never referenced
      double* s_bias_gradient = shared_mem + blockDim.x;
              ^

update_weights_kernel_batch.cu(218): warning #177-D: variable "bias_gradient" was declared but never referenced
      double bias_gradient = 0.0;
             ^

update_weights_kernel_batch.cu(303): warning #177-D: variable "bias_gradient" was declared but never referenced
      double bias_gradient = 0.0;
             ^

Compilation successful
Running benchmark 'update_weights_kernel_batch'...

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Correctness: PASS
  Average time: 0.2263 ms
  Min time:     0.2253 ms
  Max time:     0.2312 ms
  Std dev:      0.0010 ms
  Performance metrics:
    Elements/sec: 14210.58 million
    Memory bandwidth: 113.68 GB/s
    Batch size: 32

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Correctness: PASS
  Average time: 0.2925 ms
  Min time:     0.2908 ms
  Max time:     0.2952 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Elements/sec: 21983.60 million
    Memory bandwidth: 175.87 GB/s
    Batch size: 64

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Correctness: PASS
  Average time: 0.5355 ms
  Min time:     0.5332 ms
  Max time:     0.5489 ms
  Std dev:      0.0017 ms
  Performance metrics:
    Elements/sec: 24019.48 million
    Memory bandwidth: 192.16 GB/s
    Batch size: 128

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Correctness: PASS
  Average time: 0.6887 ms
  Min time:     0.5819 ms
  Max time:     1.0235 ms
  Std dev:      0.1866 ms
  Performance metrics:
    Elements/sec: 37351.61 million
    Memory bandwidth: 298.81 GB/s
    Batch size: 256

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 6.327879e-04 at index 83
    Bias values at failure point: ref=-0.059571, test=-0.060204
  Average time: 1.0962 ms
  Min time:     0.9848 ms
  Max time:     1.1383 ms
  Std dev:      0.0568 ms
  Performance metrics:
    Elements/sec: 46929.63 million
    Memory bandwidth: 375.44 GB/s
    Batch size: 512

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 4.642504e-04 at index 89
    Bias values at failure point: ref=0.408100, test=0.407635
  Average time: 1.9309 ms
  Min time:     1.9266 ms
  Max time:     1.9489 ms
  Std dev:      0.0057 ms
  Performance metrics:
    Elements/sec: 53287.42 million
    Memory bandwidth: 426.30 GB/s
    Batch size: 1024

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking advanced kernel with batch size 32...
Results for advanced kernel with batch size 32:
  Correctness: PASS
  Average time: 0.0756 ms
  Min time:     0.0742 ms
  Max time:     0.0885 ms
  Std dev:      0.0014 ms
  Performance metrics:
    Elements/sec: 42528.69 million
    Memory bandwidth: 340.23 GB/s
    Batch size: 32

Benchmarking advanced kernel with batch size 64...
Results for advanced kernel with batch size 64:
  Correctness: PASS
  Average time: 0.1343 ms
  Min time:     0.1331 ms
  Max time:     0.1369 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 47871.10 million
    Memory bandwidth: 382.97 GB/s
    Batch size: 64

Benchmarking advanced kernel with batch size 128...
Results for advanced kernel with batch size 128:
  Correctness: PASS
  Average time: 0.2526 ms
  Min time:     0.2514 ms
  Max time:     0.2544 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 50907.08 million
    Memory bandwidth: 407.26 GB/s
    Batch size: 128

Benchmarking advanced kernel with batch size 256...
Results for advanced kernel with batch size 256:
  Correctness: PASS
  Average time: 0.4892 ms
  Min time:     0.4877 ms
  Max time:     0.4910 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 52586.32 million
    Memory bandwidth: 420.69 GB/s
    Batch size: 256

Benchmarking advanced kernel with batch size 512...
Results for advanced kernel with batch size 512:
  Correctness: PASS
  Average time: 0.9631 ms
  Min time:     0.9606 ms
  Max time:     0.9667 ms
  Std dev:      0.0011 ms
  Performance metrics:
    Elements/sec: 53416.96 million
    Memory bandwidth: 427.34 GB/s
    Batch size: 512

Benchmarking advanced kernel with batch size 1024...
Results for advanced kernel with batch size 1024:
  Correctness: PASS
  Average time: 1.9073 ms
  Min time:     1.9046 ms
  Max time:     1.9102 ms
  Std dev:      0.0014 ms
  Performance metrics:
    Elements/sec: 53946.45 million
    Memory bandwidth: 431.57 GB/s
    Batch size: 1024

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking vectorized2 kernel with batch size 32...
Results for vectorized2 kernel with batch size 32:
  Correctness: PASS
  Average time: 0.0435 ms
  Min time:     0.0425 ms
  Max time:     0.0451 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Elements/sec: 73871.46 million
    Memory bandwidth: 590.97 GB/s
    Batch size: 32

Benchmarking vectorized2 kernel with batch size 64...
Results for vectorized2 kernel with batch size 64:
  Correctness: PASS
  Average time: 0.0708 ms
  Min time:     0.0696 ms
  Max time:     0.0735 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Elements/sec: 90801.05 million
    Memory bandwidth: 726.41 GB/s
    Batch size: 64

Benchmarking vectorized2 kernel with batch size 128...
Results for vectorized2 kernel with batch size 128:
  Correctness: PASS
  Average time: 0.1253 ms
  Min time:     0.1237 ms
  Max time:     0.1289 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Elements/sec: 102632.47 million
    Memory bandwidth: 821.06 GB/s
    Batch size: 128

Benchmarking vectorized2 kernel with batch size 256...
Results for vectorized2 kernel with batch size 256:
  Correctness: PASS
  Average time: 0.2339 ms
  Min time:     0.2322 ms
  Max time:     0.2357 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Elements/sec: 109982.63 million
    Memory bandwidth: 879.86 GB/s
    Batch size: 256

Benchmarking vectorized2 kernel with batch size 512...
Results for vectorized2 kernel with batch size 512:
  Correctness: PASS
  Average time: 0.4509 ms
  Min time:     0.4485 ms
  Max time:     0.4659 ms
  Std dev:      0.0019 ms
  Performance metrics:
    Elements/sec: 114092.28 million
    Memory bandwidth: 912.74 GB/s
    Batch size: 512

Benchmarking vectorized2 kernel with batch size 1024...
Results for vectorized2 kernel with batch size 1024:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 6.959644e-04 at index 97
    Bias values at failure point: ref=0.262468, test=0.263164
  Average time: 0.9529 ms
  Min time:     0.9000 ms
  Max time:     0.9873 ms
  Std dev:      0.0334 ms
  Performance metrics:
    Elements/sec: 107980.89 million
    Memory bandwidth: 863.85 GB/s
    Batch size: 1024

===== BENCHMARKING KERNEL TYPE 3 =====

Benchmarking vectorized4 kernel with batch size 32...
Results for vectorized4 kernel with batch size 32:
  Correctness: PASS
  Average time: 0.0463 ms
  Min time:     0.0437 ms
  Max time:     0.0492 ms
  Std dev:      0.0011 ms
  Performance metrics:
    Elements/sec: 69413.82 million
    Memory bandwidth: 555.31 GB/s
    Batch size: 32

Benchmarking vectorized4 kernel with batch size 64...
Results for vectorized4 kernel with batch size 64:
  Correctness: PASS
  Average time: 0.0722 ms
  Min time:     0.0706 ms
  Max time:     0.0824 ms
  Std dev:      0.0013 ms
  Performance metrics:
    Elements/sec: 89056.28 million
    Memory bandwidth: 712.45 GB/s
    Batch size: 64

Benchmarking vectorized4 kernel with batch size 128...
Results for vectorized4 kernel with batch size 128:
  Correctness: PASS
  Average time: 0.1270 ms
  Min time:     0.1255 ms
  Max time:     0.1286 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Elements/sec: 101310.24 million
    Memory bandwidth: 810.48 GB/s
    Batch size: 128

Benchmarking vectorized4 kernel with batch size 256...
Results for vectorized4 kernel with batch size 256:
  Correctness: PASS
  Average time: 0.2351 ms
  Min time:     0.2335 ms
  Max time:     0.2383 ms
  Std dev:      0.0011 ms
  Performance metrics:
    Elements/sec: 109402.62 million
    Memory bandwidth: 875.22 GB/s
    Batch size: 256

Benchmarking vectorized4 kernel with batch size 512...
Results for vectorized4 kernel with batch size 512:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 5.193253e-04 at index 106
    Bias values at failure point: ref=0.020630, test=0.021150
  Average time: 0.4551 ms
  Min time:     0.4521 ms
  Max time:     0.4599 ms
  Std dev:      0.0021 ms
  Performance metrics:
    Elements/sec: 113038.36 million
    Memory bandwidth: 904.31 GB/s
    Batch size: 512

Benchmarking vectorized4 kernel with batch size 1024...
Results for vectorized4 kernel with batch size 1024:
  Correctness: FAIL - Max weight diff: 0.000000e+00 at index -1, Max bias diff: 4.525581e-04 at index 22
    Bias values at failure point: ref=0.342672, test=0.343124
  Average time: 0.9423 ms
  Min time:     0.8967 ms
  Max time:     0.9736 ms
  Std dev:      0.0244 ms
  Performance metrics:
    Elements/sec: 109192.81 million
    Memory bandwidth: 873.54 GB/s
    Batch size: 1024

Benchmarking complete.
Benchmark completed successfully
<-arch=sm_70 --use_fast_math -lineinfo ben                      <dden_layer_kernel_batch.cu -o hidden_benchmark
cc1plus: fatal error: benchmark/hidden_layer_kernel_batch.cu: No such file or directory
compilation terminated.
<d                                                              <d ..u@VM-0-11-ubuntu:~/kiv/18646_     
<-arch=sm_70 --use_fast_math -lineinfo ben                      <dden_layer_kernel_batch.cu -o hidden_benchmark
benchmark/hidden_layer_kernel_batch.cu(335): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

benchmark/hidden_layer_kernel_batch.cu(335): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

</hidden_benchmark                                              </hidden_benchmark         

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS
  Vectorized kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.1867 ms
  Min time:     0.1851 ms
  Max time:     0.1883 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        171420.75 images/sec
    Computational:     34.40 GFLOPS
    Memory bandwidth:  5.56 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.1624 ms
  Min time:     0.1516 ms
  Max time:     0.1882 ms
  Std dev:      0.0149 ms
  Performance metrics:
    Throughput:        394164.78 images/sec
    Computational:     79.11 GFLOPS
    Memory bandwidth:  7.83 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.2960 ms
  Min time:     0.2948 ms
  Max time:     0.2990 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        432468.88 images/sec
    Computational:     86.80 GFLOPS
    Memory bandwidth:  5.87 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.5886 ms
  Min time:     0.5875 ms
  Max time:     0.5899 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        434928.25 images/sec
    Computational:     87.29 GFLOPS
    Memory bandwidth:  4.54 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.7956 ms
  Min time:     0.5044 ms
  Max time:     1.0274 ms
  Std dev:      0.2539 ms
  Performance metrics:
    Throughput:        643510.38 images/sec
    Computational:     129.16 GFLOPS
    Memory bandwidth:  5.71 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.9902 ms
  Min time:     0.8947 ms
  Max time:     1.0401 ms
  Std dev:      0.0542 ms
  Performance metrics:
    Throughput:        1034140.19 images/sec
    Computational:     207.56 GFLOPS
    Memory bandwidth:  8.36 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0876 ms
  Min time:     0.0860 ms
  Max time:     0.0891 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        365371.56 images/sec
    Computational:     73.33 GFLOPS
    Memory bandwidth:  11.84 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0804 ms
  Min time:     0.0797 ms
  Max time:     0.0819 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        795810.88 images/sec
    Computational:     159.72 GFLOPS
    Memory bandwidth:  15.80 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.1428 ms
  Min time:     0.1404 ms
  Max time:     0.1479 ms
  Std dev:      0.0022 ms
  Performance metrics:
    Throughput:        896499.25 images/sec
    Computational:     179.93 GFLOPS
    Memory bandwidth:  12.17 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.2719 ms
  Min time:     0.2685 ms
  Max time:     0.2744 ms
  Std dev:      0.0012 ms
  Performance metrics:
    Throughput:        941428.00 images/sec
    Computational:     188.95 GFLOPS
    Memory bandwidth:  9.82 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.4932 ms
  Min time:     0.4709 ms
  Max time:     0.5279 ms
  Std dev:      0.0205 ms
  Performance metrics:
    Throughput:        1038117.75 images/sec
    Computational:     208.35 GFLOPS
    Memory bandwidth:  9.20 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.9916 ms
  Min time:     0.9011 ms
  Max time:     1.0363 ms
  Std dev:      0.0515 ms
  Performance metrics:
    Throughput:        1032646.94 images/sec
    Computational:     207.26 GFLOPS
    Memory bandwidth:  8.34 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced-optimized kernel with batch size 32...
Results for advanced-optimized kernel with batch size 32:
  Average time: 0.0841 ms
  Min time:     0.0827 ms
  Max time:     0.0856 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        380694.12 images/sec
    Computational:     76.41 GFLOPS
    Memory bandwidth:  12.34 GB/s

Benchmarking advanced-optimized kernel with batch size 64...
Results for advanced-optimized kernel with batch size 64:
  Average time: 0.0801 ms
  Min time:     0.0758 ms
  Max time:     0.0860 ms
  Std dev:      0.0037 ms
  Performance metrics:
    Throughput:        798543.38 images/sec
    Computational:     160.27 GFLOPS
    Memory bandwidth:  15.86 GB/s

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.1443 ms
  Min time:     0.1398 ms
  Max time:     0.1486 ms
  Std dev:      0.0029 ms
  Performance metrics:
    Throughput:        887293.94 images/sec
    Computational:     178.08 GFLOPS
    Memory bandwidth:  12.05 GB/s

Benchmarking advanced-optimized kernel with batch size 256...
Results for advanced-optimized kernel with batch size 256:
  Average time: 0.2721 ms
  Min time:     0.2687 ms
  Max time:     0.2785 ms
  Std dev:      0.0023 ms
  Performance metrics:
    Throughput:        940698.25 images/sec
    Computational:     188.80 GFLOPS
    Memory bandwidth:  9.82 GB/s

Benchmarking advanced-optimized kernel with batch size 512...
Results for advanced-optimized kernel with batch size 512:
  Average time: 0.4883 ms
  Min time:     0.4669 ms
  Max time:     0.5284 ms
  Std dev:      0.0205 ms
  Performance metrics:
    Throughput:        1048439.94 images/sec
    Computational:     210.43 GFLOPS
    Memory bandwidth:  9.30 GB/s

Benchmarking advanced-optimized kernel with batch size 1024...
Results for advanced-optimized kernel with batch size 1024:
  Average time: 0.9863 ms
  Min time:     0.9073 ms
  Max time:     1.0324 ms
  Std dev:      0.0517 ms
  Performance metrics:
    Throughput:        1038175.12 images/sec
    Computational:     208.37 GFLOPS
    Memory bandwidth:  8.39 GB/s

===== BENCHMARKING KERNEL TYPE 3 =====

Benchmarking vectorized kernel with batch size 32...
Results for vectorized kernel with batch size 32:
  Average time: 0.0825 ms
  Min time:     0.0796 ms
  Max time:     0.0860 ms
  Std dev:      0.0023 ms
  Performance metrics:
    Throughput:        387769.66 images/sec
    Computational:     77.83 GFLOPS
    Memory bandwidth:  12.57 GB/s

Benchmarking vectorized kernel with batch size 64...
Results for vectorized kernel with batch size 64:
  Average time: 0.0810 ms
  Min time:     0.0799 ms
  Max time:     0.0838 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        789873.81 images/sec
    Computational:     158.53 GFLOPS
    Memory bandwidth:  15.68 GB/s

Benchmarking vectorized kernel with batch size 128...
Results for vectorized kernel with batch size 128:
  Average time: 0.1448 ms
  Min time:     0.1435 ms
  Max time:     0.1457 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        884036.44 images/sec
    Computational:     177.43 GFLOPS
    Memory bandwidth:  12.00 GB/s

Benchmarking vectorized kernel with batch size 256...
Results for vectorized kernel with batch size 256:
  Average time: 0.2728 ms
  Min time:     0.2681 ms
  Max time:     0.2766 ms
  Std dev:      0.0029 ms
  Performance metrics:
    Throughput:        938281.12 images/sec
    Computational:     188.32 GFLOPS
    Memory bandwidth:  9.79 GB/s

Benchmarking vectorized kernel with batch size 512...
Results for vectorized kernel with batch size 512:
  Average time: 0.4840 ms
  Min time:     0.4692 ms
  Max time:     0.5100 ms
  Std dev:      0.0179 ms
  Performance metrics:
    Throughput:        1057905.75 images/sec
    Computational:     212.33 GFLOPS
    Memory bandwidth:  9.38 GB/s

Benchmarking vectorized kernel with batch size 1024...
Results for vectorized kernel with batch size 1024:
  Average time: 0.9968 ms
  Min time:     0.9202 ms
  Max time:     1.0369 ms
  Std dev:      0.0440 ms
  Performance metrics:
    Throughput:        1027321.75 images/sec
    Computational:     206.19 GFLOPS
    Memory bandwidth:  8.30 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_dp ./benchmark
</hidden_benchmark                                              <layer_kernel_batch.cu -o hidden_benchmark
benchmark/hidden_layer_kernel_batch.cu(335): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

benchmark/hidden_layer_kernel_batch.cu(335): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

<layer_kernel_batch.cu -o hidden_benchmark                      ubuntu@VM-0-11-ubuntu:~/kiv/18646_                              <ark    

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS
  Vectorized kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.0738 ms
  Min time:     0.0722 ms
  Max time:     0.0756 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        433354.28 images/sec
    Computational:     86.98 GFLOPS
    Memory bandwidth:  7.02 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.0755 ms
  Min time:     0.0741 ms
  Max time:     0.0778 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        847831.19 images/sec
    Computational:     170.16 GFLOPS
    Memory bandwidth:  8.42 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.0940 ms
  Min time:     0.0736 ms
  Max time:     0.1106 ms
  Std dev:      0.0170 ms
  Performance metrics:
    Throughput:        1362156.38 images/sec
    Computational:     273.39 GFLOPS
    Memory bandwidth:  9.25 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.1430 ms
  Min time:     0.1413 ms
  Max time:     0.1454 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        1789584.75 images/sec
    Computational:     359.18 GFLOPS
    Memory bandwidth:  9.34 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.2472 ms
  Min time:     0.2457 ms
  Max time:     0.2493 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        2071358.38 images/sec
    Computational:     415.73 GFLOPS
    Memory bandwidth:  9.18 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.4507 ms
  Min time:     0.4485 ms
  Max time:     0.4545 ms
  Std dev:      0.0010 ms
  Performance metrics:
    Throughput:        2272271.50 images/sec
    Computational:     456.05 GFLOPS
    Memory bandwidth:  9.18 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0501 ms
  Min time:     0.0491 ms
  Max time:     0.0512 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        639190.12 images/sec
    Computational:     128.29 GFLOPS
    Memory bandwidth:  10.36 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0529 ms
  Min time:     0.0512 ms
  Max time:     0.0547 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        1209475.50 images/sec
    Computational:     242.75 GFLOPS
    Memory bandwidth:  12.01 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.0764 ms
  Min time:     0.0744 ms
  Max time:     0.0781 ms
  Std dev:      0.0009 ms
  Performance metrics:
    Throughput:        1674466.38 images/sec
    Computational:     336.07 GFLOPS
    Memory bandwidth:  11.37 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.1445 ms
  Min time:     0.1421 ms
  Max time:     0.1480 ms
  Std dev:      0.0009 ms
  Performance metrics:
    Throughput:        1771193.00 images/sec
    Computational:     355.49 GFLOPS
    Memory bandwidth:  9.24 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.1495 ms
  Min time:     0.1458 ms
  Max time:     0.1527 ms
  Std dev:      0.0022 ms
  Performance metrics:
    Throughput:        3423880.00 images/sec
    Computational:     687.19 GFLOPS
    Memory bandwidth:  15.18 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.2754 ms
  Min time:     0.2662 ms
  Max time:     0.2863 ms
  Std dev:      0.0071 ms
  Performance metrics:
    Throughput:        3718003.25 images/sec
    Computational:     746.22 GFLOPS
    Memory bandwidth:  15.02 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced-optimized kernel with batch size 32...
Results for advanced-optimized kernel with batch size 32:
  Average time: 0.0334 ms
  Min time:     0.0305 ms
  Max time:     0.0380 ms
  Std dev:      0.0019 ms
  Performance metrics:
    Throughput:        959453.44 images/sec
    Computational:     192.57 GFLOPS
    Memory bandwidth:  15.55 GB/s

Benchmarking advanced-optimized kernel with batch size 64...
Results for advanced-optimized kernel with batch size 64:
  Average time: 0.0363 ms
  Min time:     0.0348 ms
  Max time:     0.0376 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        1762083.25 images/sec
    Computational:     353.66 GFLOPS
    Memory bandwidth:  17.49 GB/s

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.0549 ms
  Min time:     0.0534 ms
  Max time:     0.0569 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        2333096.75 images/sec
    Computational:     468.26 GFLOPS
    Memory bandwidth:  15.84 GB/s

Benchmarking advanced-optimized kernel with batch size 256...
Results for advanced-optimized kernel with batch size 256:
  Average time: 0.0915 ms
  Min time:     0.0901 ms
  Max time:     0.0923 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        2797779.50 images/sec
    Computational:     561.53 GFLOPS
    Memory bandwidth:  14.60 GB/s

Benchmarking advanced-optimized kernel with batch size 512...
Results for advanced-optimized kernel with batch size 512:
  Average time: 0.1491 ms
  Min time:     0.1459 ms
  Max time:     0.1694 ms
  Std dev:      0.0023 ms
  Performance metrics:
    Throughput:        3435031.25 images/sec
    Computational:     689.42 GFLOPS
    Memory bandwidth:  15.23 GB/s

Benchmarking advanced-optimized kernel with batch size 1024...
Results for advanced-optimized kernel with batch size 1024:
  Average time: 0.2748 ms
  Min time:     0.2646 ms
  Max time:     0.2906 ms
  Std dev:      0.0106 ms
  Performance metrics:
    Throughput:        3726197.75 images/sec
    Computational:     747.86 GFLOPS
    Memory bandwidth:  15.06 GB/s

===== BENCHMARKING KERNEL TYPE 3 =====

Benchmarking vectorized kernel with batch size 32...
Results for vectorized kernel with batch size 32:
  Average time: 0.0320 ms
  Min time:     0.0307 ms
  Max time:     0.0492 ms
  Std dev:      0.0018 ms
  Performance metrics:
    Throughput:        1000720.50 images/sec
    Computational:     200.85 GFLOPS
    Memory bandwidth:  16.22 GB/s

Benchmarking vectorized kernel with batch size 64...
Results for vectorized kernel with batch size 64:
  Average time: 0.0334 ms
  Min time:     0.0325 ms
  Max time:     0.0366 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        1913728.88 images/sec
    Computational:     384.09 GFLOPS
    Memory bandwidth:  19.00 GB/s

Benchmarking vectorized kernel with batch size 128...
Results for vectorized kernel with batch size 128:
  Average time: 0.0515 ms
  Min time:     0.0500 ms
  Max time:     0.0531 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        2485676.75 images/sec
    Computational:     498.89 GFLOPS
    Memory bandwidth:  16.87 GB/s

Benchmarking vectorized kernel with batch size 256...
Results for vectorized kernel with batch size 256:
  Average time: 0.0901 ms
  Min time:     0.0886 ms
  Max time:     0.0918 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        2839718.50 images/sec
    Computational:     569.94 GFLOPS
    Memory bandwidth:  14.82 GB/s

Benchmarking vectorized kernel with batch size 512...
Results for vectorized kernel with batch size 512:
  Average time: 0.1472 ms
  Min time:     0.1454 ms
  Max time:     0.1505 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        3478214.75 images/sec
    Computational:     698.09 GFLOPS
    Memory bandwidth:  15.42 GB/s

Benchmarking vectorized kernel with batch size 1024...
Results for vectorized kernel with batch size 1024:
  Average time: 0.2764 ms
  Min time:     0.2688 ms
  Max time:     0.3076 ms
  Std dev:      0.0115 ms
  Performance metrics:
    Throughput:        3705415.25 images/sec
    Computational:     743.69 GFLOPS
    Memory bandwidth:  14.97 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_sp ./benchmark
</hidden_benchmark                                              <layer_kernel_batch.cu -o hidden_benchmark
benchmark/hidden_layer_kernel_batch.cu(336): warning #177-D: variable "warps_per_block" was declared but never referenced
      int warps_per_block, total_warps_needed;
          ^

Remark: The warnings can be suppressed with "-diag-suppress <warning-number>"

benchmark/hidden_layer_kernel_batch.cu(336): warning #177-D: variable "total_warps_needed" was declared but never referenced
      int warps_per_block, total_warps_needed;
                           ^

<layer_kernel_batch.cu -o hidden_benchmark                      ubuntu@VM-0-11-ubuntu:~/kiv/18646_                              <ark    

Verifying correctness with batch size 32...
Correctness Results:
  Optimized kernel: PASS
  Advanced kernel: PASS
  Vectorized kernel: PASS

===== BENCHMARKING KERNEL TYPE 0 =====

Benchmarking original kernel with batch size 32...
Results for original kernel with batch size 32:
  Average time: 0.0535 ms
  Min time:     0.0522 ms
  Max time:     0.0552 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        597632.31 images/sec
    Computational:     119.95 GFLOPS
    Memory bandwidth:  9.69 GB/s

Benchmarking original kernel with batch size 64...
Results for original kernel with batch size 64:
  Average time: 0.0545 ms
  Min time:     0.0532 ms
  Max time:     0.0566 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        1174108.38 images/sec
    Computational:     235.65 GFLOPS
    Memory bandwidth:  11.66 GB/s

Benchmarking original kernel with batch size 128...
Results for original kernel with batch size 128:
  Average time: 0.0701 ms
  Min time:     0.0678 ms
  Max time:     0.0737 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        1825533.50 images/sec
    Computational:     366.39 GFLOPS
    Memory bandwidth:  12.39 GB/s

Benchmarking original kernel with batch size 256...
Results for original kernel with batch size 256:
  Average time: 0.1346 ms
  Min time:     0.1330 ms
  Max time:     0.1372 ms
  Std dev:      0.0009 ms
  Performance metrics:
    Throughput:        1901872.88 images/sec
    Computational:     381.71 GFLOPS
    Memory bandwidth:  9.92 GB/s

Benchmarking original kernel with batch size 512...
Results for original kernel with batch size 512:
  Average time: 0.2322 ms
  Min time:     0.2302 ms
  Max time:     0.2437 ms
  Std dev:      0.0014 ms
  Performance metrics:
    Throughput:        2205181.00 images/sec
    Computational:     442.59 GFLOPS
    Memory bandwidth:  9.78 GB/s

Benchmarking original kernel with batch size 1024...
Results for original kernel with batch size 1024:
  Average time: 0.4235 ms
  Min time:     0.4215 ms
  Max time:     0.4367 ms
  Std dev:      0.0020 ms
  Performance metrics:
    Throughput:        2418127.50 images/sec
    Computational:     485.33 GFLOPS
    Memory bandwidth:  9.77 GB/s

===== BENCHMARKING KERNEL TYPE 1 =====

Benchmarking loop-unrolled kernel with batch size 32...
Results for loop-unrolled kernel with batch size 32:
  Average time: 0.0474 ms
  Min time:     0.0457 ms
  Max time:     0.0492 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        674905.06 images/sec
    Computational:     135.46 GFLOPS
    Memory bandwidth:  10.94 GB/s

Benchmarking loop-unrolled kernel with batch size 64...
Results for loop-unrolled kernel with batch size 64:
  Average time: 0.0487 ms
  Min time:     0.0473 ms
  Max time:     0.0509 ms
  Std dev:      0.0007 ms
  Performance metrics:
    Throughput:        1315132.25 images/sec
    Computational:     263.95 GFLOPS
    Memory bandwidth:  13.06 GB/s

Benchmarking loop-unrolled kernel with batch size 128...
Results for loop-unrolled kernel with batch size 128:
  Average time: 0.0716 ms
  Min time:     0.0697 ms
  Max time:     0.0737 ms
  Std dev:      0.0008 ms
  Performance metrics:
    Throughput:        1786679.38 images/sec
    Computational:     358.59 GFLOPS
    Memory bandwidth:  12.13 GB/s

Benchmarking loop-unrolled kernel with batch size 256...
Results for loop-unrolled kernel with batch size 256:
  Average time: 0.0967 ms
  Min time:     0.0891 ms
  Max time:     0.1372 ms
  Std dev:      0.0154 ms
  Performance metrics:
    Throughput:        2646938.50 images/sec
    Computational:     531.25 GFLOPS
    Memory bandwidth:  13.81 GB/s

Benchmarking loop-unrolled kernel with batch size 512...
Results for loop-unrolled kernel with batch size 512:
  Average time: 0.1478 ms
  Min time:     0.1452 ms
  Max time:     0.1509 ms
  Std dev:      0.0014 ms
  Performance metrics:
    Throughput:        3465311.75 images/sec
    Computational:     695.50 GFLOPS
    Memory bandwidth:  15.36 GB/s

Benchmarking loop-unrolled kernel with batch size 1024...
Results for loop-unrolled kernel with batch size 1024:
  Average time: 0.2747 ms
  Min time:     0.2638 ms
  Max time:     0.2861 ms
  Std dev:      0.0093 ms
  Performance metrics:
    Throughput:        3727558.25 images/sec
    Computational:     748.14 GFLOPS
    Memory bandwidth:  15.06 GB/s

===== BENCHMARKING KERNEL TYPE 2 =====

Benchmarking advanced-optimized kernel with batch size 32...
Results for advanced-optimized kernel with batch size 32:
  Average time: 0.0326 ms
  Min time:     0.0306 ms
  Max time:     0.0381 ms
  Std dev:      0.0019 ms
  Performance metrics:
    Throughput:        980545.88 images/sec
    Computational:     196.80 GFLOPS
    Memory bandwidth:  15.89 GB/s

Benchmarking advanced-optimized kernel with batch size 64...
Results for advanced-optimized kernel with batch size 64:
  Average time: 0.0333 ms
  Min time:     0.0307 ms
  Max time:     0.0377 ms
  Std dev:      0.0018 ms
  Performance metrics:
    Throughput:        1921653.75 images/sec
    Computational:     385.68 GFLOPS
    Memory bandwidth:  19.08 GB/s

Benchmarking advanced-optimized kernel with batch size 128...
Results for advanced-optimized kernel with batch size 128:
  Average time: 0.0489 ms
  Min time:     0.0471 ms
  Max time:     0.0507 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        2618761.25 images/sec
    Computational:     525.60 GFLOPS
    Memory bandwidth:  17.78 GB/s

Benchmarking advanced-optimized kernel with batch size 256...
Results for advanced-optimized kernel with batch size 256:
  Average time: 0.0870 ms
  Min time:     0.0860 ms
  Max time:     0.0882 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        2943037.25 images/sec
    Computational:     590.68 GFLOPS
    Memory bandwidth:  15.36 GB/s

Benchmarking advanced-optimized kernel with batch size 512...
Results for advanced-optimized kernel with batch size 512:
  Average time: 0.1450 ms
  Min time:     0.1434 ms
  Max time:     0.1468 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        3531455.25 images/sec
    Computational:     708.78 GFLOPS
    Memory bandwidth:  15.65 GB/s

Benchmarking advanced-optimized kernel with batch size 1024...
Results for advanced-optimized kernel with batch size 1024:
  Average time: 0.2786 ms
  Min time:     0.2692 ms
  Max time:     0.3025 ms
  Std dev:      0.0114 ms
  Performance metrics:
    Throughput:        3675973.00 images/sec
    Computational:     737.78 GFLOPS
    Memory bandwidth:  14.85 GB/s

===== BENCHMARKING KERNEL TYPE 3 =====

Benchmarking vectorized kernel with batch size 32...
Results for vectorized kernel with batch size 32:
  Average time: 0.0312 ms
  Min time:     0.0295 ms
  Max time:     0.0340 ms
  Std dev:      0.0009 ms
  Performance metrics:
    Throughput:        1025862.00 images/sec
    Computational:     205.89 GFLOPS
    Memory bandwidth:  16.63 GB/s

Benchmarking vectorized kernel with batch size 64...
Results for vectorized kernel with batch size 64:
  Average time: 0.0320 ms
  Min time:     0.0308 ms
  Max time:     0.0343 ms
  Std dev:      0.0006 ms
  Performance metrics:
    Throughput:        1996983.75 images/sec
    Computational:     400.80 GFLOPS
    Memory bandwidth:  19.83 GB/s

Benchmarking vectorized kernel with batch size 128...
Results for vectorized kernel with batch size 128:
  Average time: 0.0484 ms
  Min time:     0.0456 ms
  Max time:     0.0496 ms
  Std dev:      0.0010 ms
  Performance metrics:
    Throughput:        2642427.50 images/sec
    Computational:     530.35 GFLOPS
    Memory bandwidth:  17.94 GB/s

Benchmarking vectorized kernel with batch size 256...
Results for vectorized kernel with batch size 256:
  Average time: 0.0867 ms
  Min time:     0.0859 ms
  Max time:     0.0879 ms
  Std dev:      0.0005 ms
  Performance metrics:
    Throughput:        2953652.75 images/sec
    Computational:     592.81 GFLOPS
    Memory bandwidth:  15.41 GB/s

Benchmarking vectorized kernel with batch size 512...
Results for vectorized kernel with batch size 512:
  Average time: 0.1462 ms
  Min time:     0.1449 ms
  Max time:     0.1492 ms
  Std dev:      0.0010 ms
  Performance metrics:
    Throughput:        3501905.25 images/sec
    Computational:     702.85 GFLOPS
    Memory bandwidth:  15.52 GB/s

Benchmarking vectorized kernel with batch size 1024...
Results for vectorized kernel with batch size 1024:
  Average time: 0.2733 ms
  Min time:     0.2601 ms
  Max time:     0.2989 ms
  Std dev:      0.0162 ms
  Performance metrics:
    Throughput:        3746235.25 images/sec
    Computational:     751.88 GFLOPS
    Memory bandwidth:  15.14 GB/s

Benchmarking complete.

Compile with: nvcc -O3 -arch=sm_XX --use_fast_math -lineinfo hidden_layer_kernel_batch.cu -o benchmark
Run with profiling: nvprof --metrics achieved_occupancy,inst_executed,gld_throughput,gst_throughput,dram_read_throughput,dram_write_throughput,flop_count_sp ./benchmark
<rnel_batch.cu -o hidden_benchmark                              <46_                              <ark    
rrectness with batch size 32...
Correctness Resultbash: layer_kernel_batch.cu: No such file or directory
s:
  Optimized kernel: PASS
  Advanced kernel: PASS
  Vectorized kernel: PASS

===== BENCHMARKING KEubuntu@VM-0-11-ubuntu:~/kiv/18646_group_project$ 